<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° YUNGS!XX</title>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}body{font-family:'Kanit',sans-serif;min-height:100vh;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:20px}.login-container{max-width:450px;margin:100px auto;background:#fff;border-radius:20px;padding:50px 40px;box-shadow:0 20px 60px rgba(0,0,0,.3);animation:fadeIn .5s ease-out;text-align:center}.login-logo{font-size:48px;margin-bottom:20px}.login-title{font-size:32px;font-weight:600;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:10px}.login-subtitle{color:#666;font-size:16px;margin-bottom:40px;font-weight:300}.login-form{text-align:left}.login-form .form-group{margin-bottom:20px}.login-form label{display:block;font-size:14px;font-weight:500;color:#333;margin-bottom:8px}.login-form input{width:100%;padding:14px 16px;border:2px solid #e0e0e0;background:#fff;border-radius:10px;font-family:'Kanit',sans-serif;font-size:15px;transition:all .3s ease;color:#333}.login-form input:focus{outline:0;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,.1)}.login-form input::placeholder{color:#999;font-weight:300}.login-btn{width:100%;padding:14px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border:none;border-radius:10px;font-family:'Kanit',sans-serif;font-size:16px;font-weight:500;cursor:pointer;transition:all .3s ease;margin-top:10px;box-shadow:0 4px 15px rgba(102,126,234,.4)}.login-btn:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 25px rgba(102,126,234,.5)}.login-btn:disabled{opacity:.6;cursor:not-allowed}.login-note{margin-top:25px;padding:15px;background:#f8f9fa;border-radius:10px;font-size:13px;color:#666;line-height:1.6}#passwordGroup{display:none}.user-info{position:fixed;top:20px;right:20px;background:#fff;padding:12px 20px;border-radius:10px;box-shadow:0 4px 15px rgba(0,0,0,.2);display:none;align-items:center;gap:15px;z-index:1000}.user-info.active{display:flex}.user-badge{padding:4px 12px;border-radius:6px;font-size:12px;font-weight:600}.badge-admin{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff}.badge-test{background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);color:#fff}.badge-user{background:#e8f5e8;color:#2e7d32}.user-email{font-size:14px;color:#333;font-weight:500}.logout-btn{padding:8px 16px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border:none;border-radius:8px;font-family:'Kanit',sans-serif;font-size:13px;font-weight:500;cursor:pointer;transition:all .3s ease}.logout-btn:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(102,126,234,.4)}.main-container{max-width:1400px;margin:0 auto;display:none;flex-direction:column;gap:30px}.main-container.active{display:flex}.checkin-hero{width:100%;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border-radius:20px;padding:50px 40px;box-shadow:0 20px 60px rgba(0,0,0,.3);text-align:center;color:#fff;animation:fadeIn .5s ease-out;position:relative;overflow:hidden}.checkin-hero::before{content:'';position:absolute;top:-50%;right:-50%;width:200%;height:200%;background:radial-gradient(circle,rgba(255,255,255,.1) 0%,transparent 70%);animation:pulse 3s infinite}.checkin-hero h1{font-size:36px;font-weight:700;margin-bottom:15px;text-shadow:0 2px 10px rgba(0,0,0,.2);position:relative;z-index:2}.checkin-hero p{font-size:18px;margin-bottom:30px;opacity:.95;position:relative;z-index:2}.checkin-input-group{max-width:500px;margin:0 auto;position:relative;z-index:2}.checkin-input-large{width:100%;padding:20px 25px;border:3px solid rgba(255,255,255,.3);background:rgba(255,255,255,.95);border-radius:15px;font-family:'Kanit',sans-serif;font-size:28px;font-weight:700;text-align:center;letter-spacing:8px;text-transform:uppercase;transition:all .3s ease;color:#333;box-shadow:0 10px 30px rgba(0,0,0,.2)}.checkin-input-large:focus{outline:0;border-color:#fff;background:#fff;box-shadow:0 15px 40px rgba(0,0,0,.3);transform:translateY(-2px)}.checkin-input-large::placeholder{color:#999;letter-spacing:3px;font-size:20px;font-weight:400}.checkin-buttons{display:flex;gap:15px;margin-top:25px}.checkin-buttons button{flex:1;padding:18px;font-size:18px;font-weight:600;border-radius:12px;border:none;cursor:pointer;transition:all .3s ease;text-transform:uppercase;letter-spacing:1px;box-shadow:0 8px 20px rgba(0,0,0,.2)}.btn-checkin{background:linear-gradient(135deg,#56ab2f 0%,#a8e063 100%);color:#fff}.btn-checkin:hover:not(:disabled){transform:translateY(-3px);box-shadow:0 12px 30px rgba(86,171,47,.4)}.btn-checkout{background:linear-gradient(135deg,#f2994a 0%,#f2c94c 100%);color:#fff}.btn-checkout:hover:not(:disabled){transform:translateY(-3px);box-shadow:0 12px 30px rgba(242,153,74,.4)}.checkin-buttons button:disabled{opacity:.5;cursor:not-allowed;transform:none}.checkin-info-box{background:rgba(255,255,255,.15);border-radius:12px;padding:20px;margin-top:30px;backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);position:relative;z-index:2}.checkin-info-box h3{font-size:18px;margin-bottom:12px;font-weight:600}.checkin-info-box ul{text-align:left;margin:0 auto;max-width:400px;line-height:2}.checkin-info-box ul li{font-size:15px;opacity:.9}@keyframes pulse{0%,100%{transform:translate(0,0)}50%{transform:translate(-5%,-5%)}}.top-row{display:flex;gap:30px;flex-wrap:wrap}.booking-container,.my-bookings-container{flex:1;min-width:300px;background:#fff;border-radius:20px;padding:40px 30px;box-shadow:0 20px 60px rgba(0,0,0,.2);animation:fadeIn .5s ease-out;height:fit-content}.schedule-container-full{width:100%;background:#fff;border-radius:20px;padding:40px 30px;box-shadow:0 20px 60px rgba(0,0,0,.2);animation:fadeIn .5s ease-out}.admin-dashboard{max-width:1400px;margin:0 auto;display:none}.admin-dashboard.active{display:block}.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:30px}.stat-card{background:#fff;padding:25px;border-radius:15px;box-shadow:0 4px 15px rgba(0,0,0,.15);transition:all .3s ease}.stat-card:hover{transform:translateY(-5px);box-shadow:0 8px 25px rgba(0,0,0,.2)}.stat-card h3{font-size:16px;color:#666;margin-bottom:10px}.stat-card .number{font-size:36px;font-weight:600;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.admin-section{background:#fff;padding:30px;border-radius:15px;box-shadow:0 4px 15px rgba(0,0,0,.15);margin-bottom:20px}@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}h1,h2{text-align:center;font-weight:600;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:20px}h1{font-size:28px}h2{font-size:24px}.form-group{margin-bottom:20px}.form-row{display:flex;gap:15px}.form-row .form-group{flex:1}label{display:block;font-size:14px;font-weight:500;color:#333;margin-bottom:8px}label span{color:#667eea}input,select,textarea{width:100%;padding:12px 16px;border:2px solid #e0e0e0;background:#fff;border-radius:10px;font-family:'Kanit',sans-serif;font-size:15px;transition:all .3s ease;color:#333}textarea{min-height:80px;resize:vertical}input:focus,select:focus,textarea:focus{outline:0;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,.1)}input::placeholder,textarea::placeholder{color:#999;font-weight:300}input:disabled,select:disabled,textarea:disabled{opacity:.6;cursor:not-allowed;background:#fafafa}button{width:100%;padding:14px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border:none;border-radius:10px;font-family:'Kanit',sans-serif;font-size:16px;font-weight:500;cursor:pointer;transition:all .3s ease;margin-top:10px;box-shadow:0 4px 15px rgba(102,126,234,.4)}button:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 25px rgba(102,126,234,.5)}button:disabled{opacity:.6;cursor:not-allowed}.btn-danger{background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%)}.btn-edit{background:linear-gradient(135deg,#2196f3 0%,#1976d2 100%)}.btn-success{background:linear-gradient(135deg,#56ab2f 0%,#a8e063 100%)}.btn-warning{background:linear-gradient(135deg,#f2994a 0%,#f2c94c 100%)}.loading{display:none;text-align:center;margin-top:20px}.spinner{width:40px;height:40px;margin:0 auto 10px;border:3px solid rgba(102,126,234,.2);border-top-color:#667eea;border-radius:50%;animation:spin .8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.message{padding:12px 16px;margin-top:20px;border-radius:10px;text-align:center;display:none;font-size:14px}.success{background:#d4edda;color:#155724;border:1px solid #c3e6cb}.error{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.schedule-controls{display:flex;gap:15px;margin-bottom:20px;align-items:center;flex-wrap:wrap}.schedule-controls input{max-width:200px}.schedule-table{overflow-x:auto;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,.1)}table{width:100%;border-collapse:collapse;min-width:800px}td,th{padding:14px 10px;text-align:center;border-bottom:1px solid #e0e0e0;font-size:13px}th{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;font-weight:500;position:sticky;top:0;z-index:10}th:first-child{border-top-left-radius:10px}th:last-child{border-top-right-radius:10px}td{background:#f8f9fa;font-weight:300}.room-cell{font-weight:600;background:#fff;color:#333;font-size:14px}.booked{background:#ffebee;color:#c62828;font-weight:500}.available{background:#e8f5e8;color:#2e7d32;font-weight:500;cursor:pointer;transition:all .2s ease;position:relative}.available:hover{background:#c8e6c9!important;transform:scale(1.05);box-shadow:0 2px 8px rgba(46,125,50,.3);z-index:5}.available:hover::after{content:'üìù ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≠‡∏á';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(46,125,50,.95);color:#fff;padding:8px 12px;border-radius:6px;font-size:12px;font-weight:600;white-space:nowrap;pointer-events:none;box-shadow:0 4px 12px rgba(0,0,0,.2)}.using{background:#fff3cd;color:#f57c00;font-weight:600}.canceled{background:#e0e0e0;color:#757575;font-weight:400;text-decoration:line-through}.locked{background:#e3f2fd;color:#1565c0;font-weight:600}.booked,.using,.locked{cursor:not-allowed}.booking-info{font-size:11px;line-height:1.4}.booking-item{background:#f8f9fa;padding:20px;border-radius:12px;margin-bottom:15px;border-left:5px solid #667eea;transition:all .3s ease;position:relative}.booking-item:hover{transform:translateX(5px);box-shadow:0 5px 20px rgba(0,0,0,.1)}.booking-item.checked-in{border-left-color:#f57c00;background:#fff8e1}.booking-item.checked-out{border-left-color:#2e7d32;background:#f1f8f4;opacity:.85}.booking-item.canceled{border-left-color:#9e9e9e;background:#f5f5f5;opacity:.6}.booking-item h4{color:#667eea;margin-bottom:10px;font-size:18px}.booking-item p{font-size:14px;color:#666;margin:6px 0}.booking-code-display{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:15px;border-radius:10px;margin:15px 0;text-align:center}.booking-code-display .code-label{font-size:13px;opacity:.9;margin-bottom:5px}.booking-code-display .code-value{font-size:32px;font-weight:700;letter-spacing:6px;text-shadow:0 2px 5px rgba(0,0,0,.2)}.delete-btn{width:auto;padding:10px 20px;font-size:14px;margin-top:10px}.booking-notice{background:#fff3cd;border-left:4px solid #ffc107;padding:15px;margin-bottom:20px;border-radius:8px}.booking-notice h3{color:#856404;font-size:16px;margin-bottom:10px;font-weight:600}.booking-notice ul{margin-left:20px;color:#856404;font-size:14px;line-height:1.8}.booking-notice ul li{margin:5px 0}.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.7);display:none;justify-content:center;align-items:center;z-index:9999;animation:fadeIn .3s ease-out}.modal-overlay.active{display:flex}.modal-content{background:#fff;border-radius:20px;padding:40px;max-width:600px;width:90%;max-height:90vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,0.3);animation:slideUp .3s ease-out;position:relative}@keyframes slideUp{from{opacity:0;transform:translateY(50px)}to{opacity:1;transform:translateY(0)}}.modal-header{text-align:center;margin-bottom:25px}.modal-header h2{font-size:28px;color:#667eea;margin-bottom:10px}.modal-body{text-align:left;margin-bottom:30px}.modal-body .rule-list{background:#fff3cd;border-left:4px solid #ffc107;padding:20px;border-radius:10px;margin-bottom:20px}.modal-body .rule-list h3{color:#856404;font-size:18px;margin-bottom:15px;font-weight:600}.modal-body .rule-list ul{margin-left:25px;color:#856404;font-size:15px;line-height:1.8}.modal-body .rule-list ul li{margin:8px 0}.modal-body .rule-list ul li strong{color:#664d03}.modal-footer{text-align:center}.modal-footer .button-group{display:flex;gap:10px}.modal-footer .button-group button{flex:1}.modal-btn{width:100%;padding:15px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border:none;border-radius:10px;font-family:'Kanit',sans-serif;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 15px rgba(102,126,234,0.4)}.modal-btn:hover{transform:translateY(-2px);box-shadow:0 6px 25px rgba(102,126,234,0.5)}.modal-select{width:100%;padding:12px 16px;border:2px solid #e0e0e0;background:#fff;border-radius:10px;font-family:'Kanit',sans-serif;font-size:15px;transition:all 0.3s ease;color:#333;cursor:pointer}.modal-select:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,0.1)}.modal-select:disabled{opacity:0.6;cursor:not-allowed;background:#fafafa}.edit-count-badge{display:inline-block;padding:4px 10px;background:#e3f2fd;color:#1565c0;border-radius:6px;font-size:12px;font-weight:600;margin-left:8px}.edit-count-warning{background:#ffebee;color:#c62828}.status-badge{display:inline-block;padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;margin-left:10px}.status-waiting{background:#fff3cd;color:#856404}.status-using{background:#ffe0b2;color:#e65100}.status-completed{background:#e8f5e9;color:#2e7d32}.status-canceled{background:#e0e0e0;color:#757575}.status-locked{background:#e3f2fd;color:#1565c0}.admin-checkin-monitor{max-width:1400px;margin:30px auto;background:#fff;border-radius:20px;padding:40px 30px;box-shadow:0 20px 60px rgba(0,0,0,.2);display:none}.checkin-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:30px}.checkin-stat-card{background:#f8f9fa;padding:20px;border-radius:10px;text-align:center;border:2px solid #e0e0e0;transition:all .3s ease}.checkin-stat-card:hover{transform:translateY(-3px);box-shadow:0 5px 15px rgba(0,0,0,.1)}.checkin-stat-card .number{font-size:32px;font-weight:600;color:#667eea}.checkin-stat-card .label{font-size:14px;color:#666;margin-top:5px}@keyframes pulseBooking{0%,100%{box-shadow:0 20px 60px rgba(0,0,0,.2)}50%{box-shadow:0 25px 80px rgba(102,126,234,.6);transform:scale(1.02)}}.chart-container{background:#f8f9fa;padding:20px;border-radius:10px;margin:20px 0}.chart-title{font-size:18px;font-weight:600;color:#333;margin-bottom:15px;text-align:center}.chart-bar{margin:10px 0}.chart-bar-label{display:flex;justify-content:space-between;margin-bottom:5px;font-size:13px;color:#666}.chart-bar-fill{height:30px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border-radius:5px;transition:all .3s ease;position:relative;overflow:hidden}.chart-bar-fill::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);animation:shimmer 2s infinite}@keyframes shimmer{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}.activity-feed{max-height:400px;overflow-y:auto}.activity-item{background:#fff;padding:15px;border-radius:8px;margin-bottom:10px;border-left:4px solid #667eea;transition:all .3s ease}.activity-item:hover{transform:translateX(5px);box-shadow:0 2px 8px rgba(0,0,0,.1)}.activity-item .activity-time{font-size:11px;color:#999;margin-bottom:5px}.activity-item .activity-desc{font-size:14px;color:#333}.admin-tabs{display:flex;gap:10px;margin-bottom:20px;border-bottom:2px solid #e0e0e0;flex-wrap:wrap}.admin-tab{padding:12px 24px;background:transparent;border:none;border-bottom:3px solid transparent;font-family:'Kanit',sans-serif;font-size:15px;font-weight:500;color:#666;cursor:pointer;transition:all .3s ease}.admin-tab:hover{color:#667eea}.admin-tab.active{color:#667eea;border-bottom-color:#667eea}.tab-content{display:none}.tab-content.active{display:block;animation:fadeIn .3s ease-out}.lock-item{background:#e3f2fd;padding:15px;border-radius:8px;margin-bottom:10px;border-left:4px solid #2196f3}.lock-item h4{color:#1565c0;font-size:16px;margin-bottom:8px}.lock-item p{font-size:13px;color:#666;margin:4px 0}.lock-item button{width:auto;padding:8px 16px;font-size:13px;margin-top:8px}.dashboard-quick-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:30px}.quick-stat-card{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:25px;border-radius:15px;text-align:center;box-shadow:0 4px 15px rgba(102,126,234,0.3);transition:all 0.3s ease}.quick-stat-card:hover{transform:translateY(-5px);box-shadow:0 8px 25px rgba(102,126,234,0.4)}.quick-stat-card.stat-success{background:linear-gradient(135deg,#56ab2f 0%,#a8e063 100%)}.quick-stat-card.stat-warning{background:linear-gradient(135deg,#f2994a 0%,#f2c94c 100%)}.quick-stat-card.stat-danger{background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%)}.quick-stat-card.stat-info{background:linear-gradient(135deg,#2196f3 0%,#1976d2 100%)}.quick-stat-card .icon{font-size:32px;margin-bottom:10px}.quick-stat-card .number{font-size:36px;font-weight:700;margin:10px 0}.quick-stat-card .label{font-size:14px;opacity:0.95}.export-section{background:#fff;padding:25px;border-radius:15px;box-shadow:0 4px 15px rgba(0,0,0,0.1);margin-bottom:20px}.export-controls{display:flex;gap:15px;flex-wrap:wrap;align-items:flex-end;margin-bottom:20px}.export-controls .form-group{flex:1;min-width:200px;margin-bottom:0}.export-btn{padding:12px 24px;background:linear-gradient(135deg,#56ab2f 0%,#a8e063 100%);color:#fff;border:none;border-radius:10px;font-family:'Kanit',sans-serif;font-size:15px;font-weight:600;cursor:pointer;transition:all 0.3s ease;white-space:nowrap;box-shadow:0 4px 15px rgba(86,171,47,0.3);width:auto;margin:0}.export-btn:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 25px rgba(86,171,47,0.4)}.export-btn:disabled{opacity:0.6;cursor:not-allowed}.search-section{background:#fff;padding:25px;border-radius:15px;box-shadow:0 4px 15px rgba(0,0,0,0.1);margin-bottom:20px}.search-controls{display:flex;gap:15px;flex-wrap:wrap;align-items:flex-end}.search-controls .form-group{flex:1;min-width:200px;margin-bottom:0}.search-btn{padding:12px 24px;background:linear-gradient(135deg,#2196f3 0%,#1976d2 100%);color:#fff;border:none;border-radius:10px;font-family:'Kanit',sans-serif;font-size:15px;font-weight:600;cursor:pointer;transition:all 0.3s ease;white-space:nowrap;box-shadow:0 4px 15px rgba(33,150,243,0.3);width:auto;margin:0}.search-btn:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 25px rgba(33,150,243,0.4)}.clear-search-btn{background:linear-gradient(135deg,#9e9e9e 0%,#757575 100%);box-shadow:0 4px 15px rgba(158,158,158,0.3)}.search-results-header{background:#e3f2fd;padding:15px 20px;border-radius:10px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px}.search-results-header .result-count{font-size:16px;font-weight:600;color:#1565c0}.action-buttons-group{display:flex;gap:10px;flex-wrap:wrap}.action-buttons-group button{flex:1;min-width:120px;padding:10px 16px;font-size:14px;margin:0}.export-result-message{background:#e8f5e9;border-left:4px solid #4caf50;padding:15px 20px;border-radius:8px;margin-top:15px}.export-result-message h4{color:#2e7d32;font-size:16px;margin-bottom:10px}.export-result-message p{color:#1b5e20;font-size:14px;margin:5px 0}.export-download-link{display:inline-block;padding:10px 20px;background:linear-gradient(135deg,#2196f3 0%,#1976d2 100%);color:#fff;text-decoration:none;border-radius:8px;font-weight:600;margin-top:10px;transition:all 0.3s ease}.export-download-link:hover{transform:translateY(-2px);box-shadow:0 4px 15px rgba(33,150,243,0.4)}@media (max-width: 768px){.main-container{flex-direction:column}.top-row{flex-direction:column}.booking-container,.my-bookings-container,.schedule-container-full{max-width:none}.form-row{flex-direction:column;gap:0}.user-info{position:relative;top:0;right:0;margin-bottom:20px;justify-content:center}.login-container{margin:50px auto;padding:40px 30px}.stats-grid{grid-template-columns:1fr}.modal-content{padding:30px}.checkin-hero{padding:30px 20px}.checkin-hero h1{font-size:28px}.checkin-input-large{font-size:22px;padding:15px 20px;letter-spacing:5px}.checkin-buttons{flex-direction:column}.checkin-buttons button{padding:15px}.admin-tabs{overflow-x:auto}.chart-container{padding:15px}.export-controls,.search-controls{flex-direction:column}.export-controls .form-group,.search-controls .form-group{width:100%}.export-btn,.search-btn,.clear-search-btn{width:100%}.dashboard-quick-stats{grid-template-columns:1fr}.action-buttons-group{flex-direction:column}.action-buttons-group button{width:100%}}
  </style>
</head><body>

<!-- LOGIN PAGE -->
  <div class="login-container" id="loginPage">
    <div class="login-logo">üè¢</div>
    <h1 class="login-title">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°<br>YUNGS!XX</h1>
    <p class="login-subtitle">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</p>
    <form id="loginForm" class="login-form">
      <div class="form-group">
        <label for="loginEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
        <input type="email" id="loginEmail" required placeholder="example@kkumail.com">
      </div>
      <div class="form-group" id="passwordGroup">
        <label for="loginPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
        <input type="password" id="loginPassword" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin">
      </div>
      <button type="submit" class="login-btn" id="loginBtn">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
    </form>
    <div class="login-note">üìå <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏≠‡∏µ‡πÄ‡∏°‡∏• @kkumail.com ‡πÅ‡∏•‡∏∞ @kku.ac.th ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</div>
    <div id="loginMessage" class="message"></div>
  </div>

  <!-- USER INFO BAR -->
  <div class="user-info" id="userInfo">
    <span class="user-badge" id="userBadge"></span>
    <span class="user-email" id="userEmail"></span>
    <button class="logout-btn" id="logoutBtn">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
  </div>

  <!-- RULES MODAL -->
  <div class="modal-overlay" id="rulesModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>‚ö†Ô∏è ‡∏Å‡∏é‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h2>
        <p style="color:#666;font-size:14px;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</p>
      </div>
      <div class="modal-body">
        <div class="rule-list">
          <h3>üìã ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h3>
          <ul>
            <li>‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á <strong>1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</strong></li>
            <li>‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î <strong>3 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ï‡πà‡∏≠‡∏Ñ‡∏£‡∏±‡πâ‡∏á</strong></li>
            <li>‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≠‡∏á: <strong>08:00 - 16:00 ‡∏ô.</strong></li>
            <li>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î <strong>2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</strong> (‡∏´‡πâ‡∏≠‡∏á ‡πÅ‡∏•‡∏∞/‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏ß‡∏•‡∏≤)</li>
            <li><strong>Check-in ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 15 ‡∏ô‡∏≤‡∏ó‡∏µ</strong> ‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≠‡∏á</li>
            <li><strong style="color:#dc2743;">‡πÑ‡∏°‡πà Check-in ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 15 ‡∏ô‡∏≤‡∏ó‡∏µ = ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</strong></li>
            <li>‡∏ï‡πâ‡∏≠‡∏á <strong>Check-out</strong> ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à</li>
            <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞ <strong>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤ 5 ‡∏ô‡∏≤‡∏ó‡∏µ</strong></li>
            <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞ <strong>Auto Check-out</strong> ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤</li>
            <li>‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å ‡∏•‡∏ö‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ <strong>"‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô"</strong></li>
          </ul>
        </div>
      </div>
      <div class="modal-footer">
        <button class="modal-btn" id="closeModalBtn">‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</button>
      </div>
    </div>
  </div>

  <!-- EDIT BOOKING MODAL -->
  <div class="modal-overlay" id="editBookingModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>üìù ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h2>
        <p style="color:#666;font-size:14px;">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞/‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏î‡πâ (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)</p>
      </div>
      <div class="modal-body">
        <div id="editBookingInfo" style="background:#f8f9fa;padding:15px;border-radius:10px;margin-bottom:20px;"></div>
        
        <div class="form-group">
          <label for="editRoomSelect">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° <span style="color:#667eea;">*</span></label>
          <select id="editRoomSelect" class="modal-select" required>
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á --</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 4 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 4 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 5 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 5 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 6 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 6 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)">‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)">‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)">‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</option>
          </select>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="editStartTimeSelect">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≠‡∏á <span style="color:#667eea;">*</span></label>
            <select id="editStartTimeSelect" class="modal-select" required>
              <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° --</option>
            </select>
          </div>
          <div class="form-group">
            <label for="editEndTimeSelect">‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î <span style="color:#667eea;">*</span></label>
            <select id="editEndTimeSelect" class="modal-select" required>
              <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î --</option>
            </select>
          </div>
        </div>
        
        <div style="background:#fff3cd;padding:15px;border-radius:8px;border-left:4px solid #ffc107;margin-top:15px;">
          <p style="margin:0;color:#856404;font-size:13px;">
            ‚ö†Ô∏è <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong><br>
            ‚Ä¢ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡πà‡∏≠‡∏ô Check-in<br>
            ‚Ä¢ ‡∏£‡∏´‡∏±‡∏™ Check-in ‡πÄ‡∏î‡∏¥‡∏°‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ<br>
            ‚Ä¢ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô<br>
            ‚Ä¢ ‡∏à‡∏∞‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <div class="button-group">
          <button class="modal-btn" id="confirmEditBookingBtn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
          <button class="modal-btn btn-danger" id="cancelEditBookingBtn">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        </div>
      </div>
      <div id="editBookingMessage" class="message" style="margin-top:15px;"></div>
    </div>
  </div>

  <!-- ADMIN EDIT BOOKING MODAL -->
  <div class="modal-overlay" id="adminEditModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>üîß Admin: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h2>
        <p style="color:#666;font-size:14px;">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</p>
      </div>
      <div class="modal-body">
        <div id="adminEditInfo" style="background:#f8f9fa;padding:15px;border-radius:10px;margin-bottom:20px;"></div>
        
        <div class="form-group">
          <label for="adminEditRoomSelect">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° <span style="color:#667eea;">*</span></label>
          <select id="adminEditRoomSelect" class="modal-select" required>
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á --</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 4 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 4 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 5 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 5 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 6 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 6 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)">‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)">‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)">‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</option>
          </select>
        </div>

        <div class="form-group">
          <label for="adminEditDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <span style="color:#667eea;">*</span></label>
          <input type="date" id="adminEditDate" class="modal-select" required>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="adminEditStartTime">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≠‡∏á <span style="color:#667eea;">*</span></label>
            <select id="adminEditStartTime" class="modal-select" required>
              <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° --</option>
            </select>
          </div>
          <div class="form-group">
            <label for="adminEditEndTime">‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î <span style="color:#667eea;">*</span></label>
            <select id="adminEditEndTime" class="modal-select" required>
              <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î --</option>
            </select>
          </div>
        </div>
        
        <div style="background:#e3f2fd;padding:15px;border-radius:8px;border-left:4px solid #2196f3;margin-top:15px;">
          <p style="margin:0;color:#1565c0;font-size:13px;">
            ‚ÑπÔ∏è <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong><br>
            ‚Ä¢ Admin ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î<br>
            ‚Ä¢ ‡∏à‡∏∞‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥<br>
            ‚Ä¢ ‡∏£‡∏´‡∏±‡∏™ Check-in ‡πÄ‡∏î‡∏¥‡∏°‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <div class="button-group">
          <button class="modal-btn" id="confirmAdminEditBtn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
          <button class="modal-btn btn-danger" id="cancelAdminEditBtn">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        </div>
      </div>
      <div id="adminEditMessage" class="message" style="margin-top:15px;"></div>
    </div>
  </div>

  <!-- LOCK ROOM MODAL -->
  <div class="modal-overlay" id="lockRoomModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>üîí ‡∏•‡πá‡∏≠‡∏Ñ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h2>
        <p style="color:#666;font-size:14px;">‡∏•‡πá‡∏≠‡∏Ñ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏á‡∏≤‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</p>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="lockRoomSelect">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° <span style="color:#667eea;">*</span></label>
          <select id="lockRoomSelect" class="modal-select" required>
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á --</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 4 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 4 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 5 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 5 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 6 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 6 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)">‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)">‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</option>
            <option value="‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)">‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</option>
          </select>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="lockStartDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡πá‡∏≠‡∏Ñ <span style="color:#667eea;">*</span></label>
            <input type="date" id="lockStartDate" class="modal-select" required>
          </div>
          <div class="form-group">
            <label for="lockEndDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏•‡πá‡∏≠‡∏Ñ <span style="color:#667eea;">*</span></label>
            <input type="date" id="lockEndDate" class="modal-select" required>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="lockStartTime">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°</label>
            <input type="time" id="lockStartTime" class="modal-select" value="08:00">
          </div>
          <div class="form-group">
            <label for="lockEndTime">‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label>
            <input type="time" id="lockEndTime" class="modal-select" value="16:00">
          </div>
        </div>

        <div class="form-group">
          <label for="lockReason">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Ñ <span style="color:#667eea;">*</span></label>
          <textarea id="lockReason" class="modal-select" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• ‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏™‡∏±‡∏°‡∏°‡∏ô‡∏≤" required></textarea>
        </div>
        
        <div style="background:#fff3cd;padding:15px;border-radius:8px;border-left:4px solid #ffc107;margin-top:15px;">
          <p style="margin:0;color:#856404;font-size:13px;">
            ‚ö†Ô∏è <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong><br>
            ‚Ä¢ ‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏•‡πá‡∏≠‡∏Ñ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ<br>
            ‚Ä¢ ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ß‡πà‡∏≤ "‡∏•‡πá‡∏≠‡∏Ñ‡πÑ‡∏ß‡πâ"<br>
            ‚Ä¢ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Dashboard
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <div class="button-group">
          <button class="modal-btn" id="confirmLockRoomBtn">üîí ‡∏•‡πá‡∏≠‡∏Ñ‡∏´‡πâ‡∏≠‡∏á</button>
          <button class="modal-btn btn-danger" id="cancelLockRoomBtn">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        </div>
      </div>
      <div id="lockRoomMessage" class="message" style="margin-top:15px;"></div>
    </div>
  </div>

  <!-- MAIN CONTAINER (USER) -->
  <div class="main-container" id="mainContainer">
    <!-- CHECK-IN SECTION -->
    <div class="checkin-hero">
      <h1>üîê Check-in / Check-out</h1>
      <p>‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏≤‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏• ‡πÄ‡∏û‡∏∑‡πà‡∏≠ Check-in ‡∏´‡∏£‡∏∑‡∏≠ Check-out</p>
      <div class="checkin-input-group">
        <input type="text" id="checkinCodeInput" class="checkin-input-large" maxlength="6" placeholder="A1B2C3" autocomplete="off">
        <div class="checkin-buttons">
          <button type="button" id="checkinBtn" class="btn-checkin">‚úì Check-in</button>
          <button type="button" id="checkoutBtn" class="btn-checkout">‚úì Check-out</button>
        </div>
      </div>
      <div class="checkin-info-box">
        <h3>üì± ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
        <ul>
          <li>‚úâÔ∏è ‡∏£‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™ 6 ‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏≤‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•</li>
          <li>‚è∞ Check-in ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 15 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°</li>
          <li>‚ùå ‡πÑ‡∏°‡πà Check-in ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 15 ‡∏ô‡∏≤‡∏ó‡∏µ = ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</li>
          <li>‚úÖ Check-out ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à</li>
          <li>üîî ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤ 5 ‡∏ô‡∏≤‡∏ó‡∏µ</li>
          <li>ü§ñ Auto Check-out ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤</li>
        </ul>
      </div>
      <div id="checkinMessage" class="message"></div>
    </div>

    <div class="top-row">
      <!-- BOOKING FORM -->
      <div class="booking-container">
        <h1>‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h1>
        <div class="booking-notice">
          <h3>üìã ‡∏Å‡∏é‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á</h3>
          <ul>
            <li>‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á <strong>1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô</strong></li>
            <li>‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î <strong>3 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ï‡πà‡∏≠‡∏Ñ‡∏£‡∏±‡πâ‡∏á</strong></li>
            <li>‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≠‡∏á: 08:00 - 16:00 ‡∏ô.</li>
            <li>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î <strong>2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</strong> (‡∏Å‡πà‡∏≠‡∏ô Check-in)</li>
            <li><strong style="color:#dc2743;">Check-in ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 15 ‡∏ô‡∏≤‡∏ó‡∏µ ‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</strong></li>
          </ul>
        </div>
        <form id="bookingForm">
          <div class="form-group">
            <label for="room">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° <span>*</span></label>
            <select id="room" required>
              <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á --</option>
              <option value="‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
              <option value="‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
              <option value="‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
              <option value="‡∏´‡πâ‡∏≠‡∏á 4 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 4 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
              <option value="‡∏´‡πâ‡∏≠‡∏á 5 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 5 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
              <option value="‡∏´‡πâ‡∏≠‡∏á 6 (‡∏ä‡∏±‡πâ‡∏ô 1)">‡∏´‡πâ‡∏≠‡∏á 6 (‡∏ä‡∏±‡πâ‡∏ô 1)</option>
              <option value="‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)">‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</option>
              <option value="‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)">‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</option>
              <option value="‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)">‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á <span>*</span></label>
            <input type="date" id="date" required>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="startTime">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≠‡∏á <span>*</span></label>
              <select id="startTime" required disabled>
                <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡πà‡∏≠‡∏ô --</option>
              </select>
            </div>
            <div class="form-group">
              <label for="endTime">‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î <span>*</span></label>
              <select id="endTime" required disabled>
                <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô --</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="name">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á <span>*</span></label>
            <input type="text" id="name" required placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="department">‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤ <span>*</span></label>
              <input type="text" id="department" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå">
            </div>
            <div class="form-group">
              <label for="studentId">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ <span>*</span></label>
              <input type="text" id="studentId" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 65010001">
            </div>
          </div>
          <div class="form-group">
            <label for="phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö <span>*</span></label>
            <input type="tel" id="phone" required pattern="[0-9]{10}" placeholder="0812345678">
          </div>
          <button type="submit" id="submitBtn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</button>
        </form>
        <div class="loading"><div class="spinner"></div><p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...</p></div>
        <div id="message" class="message"></div>
      </div>

      <!-- MY BOOKINGS -->
      <div class="my-bookings-container">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;">
          <h2 style="margin:0;">‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</h2>
          <button type="button" onclick="loadMyBookings()" style="width:auto;padding:8px 16px;font-size:14px;margin:0;">
            üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
          </button>
        </div>
        <div id="myBookingsList"></div>
      </div>
    </div>

    <!-- SCHEDULE TABLE -->
    <div class="schedule-container-full">
      <h2>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á</h2>
      
      <div style="background:#e3f2fd;padding:12px 20px;border-radius:10px;margin-bottom:20px;border-left:4px solid #2196f3;">
        <p style="margin:0;color:#1565c0;font-size:14px;">
          üí° <strong>‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö:</strong> ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á <span style="background:#e8f5e8;color:#2e7d32;padding:2px 8px;border-radius:4px;font-weight:600;">‡∏ß‡πà‡∏≤‡∏á</span> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ!
        </p>
      </div>
      
      <div class="schedule-controls">
        <input type="date" id="scheduleDate">
        <button type="button" id="loadScheduleBtn">‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á</button>
      </div>
      <div class="schedule-table">
        <table>
          <thead>
            <tr>
              <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
              <th>‡∏´‡πâ‡∏≠‡∏á 1<br>(‡∏ä‡∏±‡πâ‡∏ô 1)</th>
              <th>‡∏´‡πâ‡∏≠‡∏á 2<br>(‡∏ä‡∏±‡πâ‡∏ô 1)</th>
              <th>‡∏´‡πâ‡∏≠‡∏á 3<br>(‡∏ä‡∏±‡πâ‡∏ô 1)</th>
              <th>‡∏´‡πâ‡∏≠‡∏á 4<br>(‡∏ä‡∏±‡πâ‡∏ô 1)</th>
              <th>‡∏´‡πâ‡∏≠‡∏á 5<br>(‡∏ä‡∏±‡πâ‡∏ô 1)</th>
              <th>‡∏´‡πâ‡∏≠‡∏á 6<br>(‡∏ä‡∏±‡πâ‡∏ô 1)</th>
              <th>‡∏´‡πâ‡∏≠‡∏á 1<br>(‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</th>
              <th>‡∏´‡πâ‡∏≠‡∏á 2<br>(‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</th>
              <th>‡∏´‡πâ‡∏≠‡∏á 3<br>(‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)</th>
            </tr>
          </thead>
          <tbody id="scheduleBody">
            <tr><td colspan="10" style="text-align:center;padding:30px;color:#666;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div><!-- ADMIN DASHBOARD -->
  <div class="admin-dashboard" id="adminDashboard">
    <h1>üéØ Admin Dashboard</h1>
    
    <!-- ADMIN TABS -->
    <div class="admin-tabs">
      <button class="admin-tab active" data-tab="overview">üìä ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</button>
      <button class="admin-tab" data-tab="bookings">üìã ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
      <button class="admin-tab" data-tab="checkins">‚úÖ Check-in ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
      <button class="admin-tab" data-tab="locks">üîí ‡∏•‡πá‡∏≠‡∏Ñ‡∏´‡πâ‡∏≠‡∏á</button>
      <button class="admin-tab" data-tab="analytics">üìà ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</button>
      <button class="admin-tab" data-tab="export">üíæ Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
    </div>

    <!-- TAB: OVERVIEW -->
    <div class="tab-content active" id="overviewTab">
      <!-- Quick Stats Today -->
      <h2 style="margin-bottom:20px;">üìÖ ‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h2>
      <div class="dashboard-quick-stats">
        <div class="quick-stat-card stat-info">
          <div class="icon">üìã</div>
          <div class="number" id="quickTotalToday">0</div>
          <div class="label">‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
        </div>
        <div class="quick-stat-card stat-warning">
          <div class="icon">‚è≥</div>
          <div class="number" id="quickWaitingCheckin">0</div>
          <div class="label">‡∏£‡∏≠ Check-in</div>
        </div>
        <div class="quick-stat-card stat-success">
          <div class="icon">‚úÖ</div>
          <div class="number" id="quickCheckedInToday">0</div>
          <div class="label">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>
        </div>
        <div class="quick-stat-card">
          <div class="icon">üèÅ</div>
          <div class="number" id="quickCompletedToday">0</div>
          <div class="label">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
        </div>
        <div class="quick-stat-card stat-danger">
          <div class="icon">‚ùå</div>
          <div class="number" id="quickCancelledToday">0</div>
          <div class="label">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
        </div>
      </div>

      <!-- Overall Stats -->
      <h2 style="margin-bottom:20px;margin-top:30px;">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏£‡∏ß‡∏°</h2>
      <div class="stats-grid">
        <div class="stat-card"><h3>‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3><div class="number" id="totalBookings">0</div></div>
        <div class="stat-card"><h3>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3><div class="number" id="activeBookings">0</div></div>
        <div class="stat-card"><h3>‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß</h3><div class="number" id="completedBookings">0</div></div>
        <div class="stat-card"><h3>‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</h3><div class="number" id="cancelledBookings">0</div></div>
        <div class="stat-card"><h3>‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</h3><div class="number" id="weekBookings">0</div></div>
        <div class="stat-card"><h3>‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</h3><div class="number" id="monthBookings">0</div></div>
        <div class="stat-card"><h3>‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3><div class="number" id="totalUsers">0</div></div>
      </div>

      <!-- Recent Activity -->
      <div class="admin-section">
        <h2>üïê ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h2>
        <div id="recentActivity" class="activity-feed"></div>
      </div>
    </div>

    <!-- TAB: BOOKINGS -->
    <div class="tab-content" id="bookingsTab">
      <!-- Search Section -->
      <div class="search-section">
        <h2>üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h2>
        <div class="search-controls">
          <div class="form-group">
            <label for="searchType">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏≤‡∏Å</label>
            <select id="searchType" class="modal-select">
              <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
              <option value="name">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á</option>
              <option value="email">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</option>
              <option value="room">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
              <option value="studentId">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option>
              <option value="checkinCode">‡∏£‡∏´‡∏±‡∏™ Check-in</option>
            </select>
          </div>
          <div class="form-group">
            <label for="searchTerm">‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</label>
            <input type="text" id="searchTerm" class="modal-select" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...">
          </div>
          <button type="button" class="search-btn" onclick="searchBookings()">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
          <button type="button" class="search-btn clear-search-btn" onclick="clearSearch()">‚úï ‡∏•‡πâ‡∏≤‡∏á</button>
        </div>
      </div>

      <!-- All Bookings -->
      <div class="admin-section">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:10px;">
          <h2 style="margin:0;">üìã ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
          <button type="button" onclick="loadAdminDashboard()" style="width:auto;padding:10px 20px;font-size:14px;margin:0;">
            üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
          </button>
        </div>
        <div id="searchResultsHeader" style="display:none;"></div>
        <div id="allBookingsList"></div>
      </div>
    </div>

    <!-- TAB: CHECKINS -->
    <div class="tab-content" id="checkinsTab">
      <div class="admin-section">
        <h2>üéØ ‡∏Å‡∏≤‡∏£ Check-in ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h2>
        <div id="todayCheckinsList"></div>
      </div>
    </div>

    <!-- TAB: LOCKS -->
    <div class="tab-content" id="locksTab">
      <div class="admin-section">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:10px;">
          <h2 style="margin:0;">üîí ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Ñ‡∏´‡πâ‡∏≠‡∏á</h2>
          <button type="button" onclick="openLockRoomModal()" class="btn-warning" style="width:auto;padding:10px 20px;font-size:14px;margin:0;">
            ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡πá‡∏≠‡∏Ñ‡∏´‡πâ‡∏≠‡∏á
          </button>
        </div>
        <div id="roomLocksList"></div>
      </div>
    </div>

    <!-- TAB: ANALYTICS -->
    <div class="tab-content" id="analyticsTab">
      <div class="admin-section">
        <h2>üìà ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h2>
        <div class="chart-container">
          <div class="chart-title">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡πâ‡∏≠‡∏á</div>
          <div id="roomUsageChart"></div>
        </div>
      </div>

      <div class="admin-section">
        <h2>‚è∞ ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏¥‡∏¢‡∏°</h2>
        <div class="chart-container">
          <div class="chart-title">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</div>
          <div id="peakHoursChart"></div>
        </div>
      </div>
    </div>

    <!-- TAB: EXPORT -->
    <div class="tab-content" id="exportTab">
      <div class="export-section">
        <h2>üíæ Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h2>
        <p style="color:#666;margin-bottom:20px;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Export ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå Excel</p>
        
        <div class="export-controls">
          <div class="form-group">
            <label for="exportType">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</label>
            <select id="exportType" class="modal-select">
              <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
              <option value="today">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</option>
              <option value="week">‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</option>
              <option value="month">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</option>
              <option value="daterange">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</option>
              <option value="active">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
              <option value="completed">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß</option>
              <option value="cancelled">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</option>
            </select>
          </div>
          
          <div class="form-group" id="exportDateRangeGroup" style="display:none;">
            <label for="exportStartDate">‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
            <input type="date" id="exportStartDate" class="modal-select">
          </div>
          
          <div class="form-group" id="exportDateRangeGroup2" style="display:none;">
            <label for="exportEndDate">‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
            <input type="date" id="exportEndDate" class="modal-select">
          </div>
          
          <button type="button" class="export-btn" onclick="exportToExcel()">
            üì• Export Excel
          </button>
        </div>

        <div id="exportResultMessage" style="display:none;"></div>
      </div>

      <!-- Export History -->
      <div class="admin-section">
        <h2>üìã ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h2>
        <div style="background:#f8f9fa;padding:20px;border-radius:10px;line-height:1.8;">
          <h3 style="color:#667eea;margin-bottom:10px;">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£ Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô:</h3>
          <ol style="margin-left:20px;color:#666;">
            <li>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å <strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</strong> ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</li>
            <li>‡∏´‡∏≤‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà" ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</li>
            <li>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° <strong>Export Excel</strong></li>
            <li>‡∏£‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• (‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å)</li>
            <li>‡∏Ñ‡∏•‡∏¥‡∏Å <strong>Download</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå</li>
          </ol>
          
          <h3 style="color:#667eea;margin:20px 0 10px 0;">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô:</h3>
          <ul style="margin-left:20px;color:#666;">
            <li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</li>
            <li>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Check-in/Check-out</li>
            <li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á (‡∏ä‡∏∑‡πà‡∏≠, ‡∏≠‡∏µ‡πÄ‡∏°‡∏•, ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£)</li>
            <li>‡∏£‡∏´‡∏±‡∏™ Check-in</li>
            <li>‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</li>
          </ul>

          <div style="background:#e3f2fd;padding:15px;border-radius:8px;border-left:4px solid #2196f3;margin-top:15px;">
            <p style="margin:0;color:#1565c0;font-size:14px;">
              üí° <strong>Tips:</strong> ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà Export ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏°‡∏µ‡∏™‡∏µ‡∏™‡∏•‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á
            </p>
          </div>
        </div>
      </div>
    </div>
  </div><script>
    // ===============================================================================================
    // JAVASCRIPT - Complete Implementation Rev14
    // Part 1: Variables, Initialization & Event Listeners
    // ===============================================================================================
    
    // ===============================
    // GLOBAL VARIABLES
    // ===============================
    
    let userLoggedIn = false;
    let userEmail = '';
    let userType = '';
    let autoRefreshInterval = null;
    let currentAdminEditBooking = null;
    let currentEditBooking = null;
    let isSearchMode = false;
    
    const allRooms = [
      '‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô 1)', '‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô 1)', '‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô 1)',
      '‡∏´‡πâ‡∏≠‡∏á 4 (‡∏ä‡∏±‡πâ‡∏ô 1)', '‡∏´‡πâ‡∏≠‡∏á 5 (‡∏ä‡∏±‡πâ‡∏ô 1)', '‡∏´‡πâ‡∏≠‡∏á 6 (‡∏ä‡∏±‡πâ‡∏ô 1)',
      '‡∏´‡πâ‡∏≠‡∏á 1 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)', '‡∏´‡πâ‡∏≠‡∏á 2 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)', '‡∏´‡πâ‡∏≠‡∏á 3 (‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô)'
    ];
    
    const allTimes = [
      '08:00', '08:30', '09:00', '09:30', '10:00', '10:30', '11:00', '11:30', 
      '12:00', '12:30', '13:00', '13:30', '14:00', '14:30', '15:00', '15:30'
    ];

    // ===============================
    // INITIALIZATION
    // ===============================

    window.onload = function() {
      const savedEmail = sessionStorage.getItem('userEmail');
      const savedType = sessionStorage.getItem('userType');
      
      if (savedEmail && savedType) {
        userEmail = savedEmail;
        userType = savedType;
        userLoggedIn = true;
        showApp();
      }
      
      const today = new Date();
      const dd = String(today.getDate()).padStart(2, '0');
      const mm = String(today.getMonth() + 1).padStart(2, '0');
      const yyyy = today.getFullYear();
      const todayStr = yyyy + '-' + mm + '-' + dd;
      
      document.getElementById('date').setAttribute('min', todayStr);
      document.getElementById('scheduleDate').setAttribute('min', todayStr);
      document.getElementById('scheduleDate').value = todayStr;
      document.getElementById('lockStartDate').setAttribute('min', todayStr);
      document.getElementById('lockEndDate').setAttribute('min', todayStr);
      document.getElementById('adminEditDate').setAttribute('min', todayStr);
      document.getElementById('exportStartDate').setAttribute('min', todayStr);
      document.getElementById('exportEndDate').setAttribute('min', todayStr);
      
      if (userLoggedIn) {
        loadSchedule();
        if (userType === 'user' || userType === 'test') {
          loadMyBookings();
        } else if (userType === 'admin') {
          loadAdminDashboard();
          loadTodayCheckins();
          loadRoomLocks();
          loadDashboardAnalytics();
          loadQuickStats();
        }
      }
    };

    // ===============================
    // EVENT LISTENERS
    // ===============================

    document.getElementById('loginEmail').addEventListener('input', function() {
      const email = this.value.toLowerCase().trim();
      const passwordGroup = document.getElementById('passwordGroup');
      
      if (email === 'forworkyungsixx@gmail.com') {
        passwordGroup.style.display = 'block';
        document.getElementById('loginPassword').required = true;
      } else {
        passwordGroup.style.display = 'none';
        document.getElementById('loginPassword').required = false;
        document.getElementById('loginPassword').value = '';
      }
    });

    document.getElementById('loginForm').addEventListener('submit', handleLogin);
    document.getElementById('logoutBtn').addEventListener('click', handleLogout);

    document.getElementById('room').addEventListener('change', function() {
      updateAvailableSlots();
      document.getElementById('endTime').value = '';
      document.getElementById('submitBtn').disabled = true;
    });

    document.getElementById('date').addEventListener('change', function() {
      updateAvailableSlots();
      document.getElementById('endTime').value = '';
      document.getElementById('submitBtn').disabled = true;
    });

    document.getElementById('startTime').addEventListener('change', function() {
      updateEndTimeSlots();
      document.getElementById('endTime').value = '';
      document.getElementById('submitBtn').disabled = true;
    });

    document.getElementById('endTime').addEventListener('change', function() {
      const room = document.getElementById('room').value;
      const date = document.getElementById('date').value;
      const startTime = document.getElementById('startTime').value;
      const endTime = this.value;
      
      if (room && date && startTime && endTime) {
        const submitBtn = document.getElementById('submitBtn');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'üîç ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡πà‡∏≤‡∏á...';
        
        google.script.run
          .withSuccessHandler(function(isDuplicate) {
            if (isDuplicate) {
              showMessage('‚ö†Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏°‡∏µ‡∏Ñ‡∏ô‡∏à‡∏≠‡∏á‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏∑‡πà‡∏ô', 'error');
              document.getElementById('endTime').value = '';
              submitBtn.disabled = true;
              submitBtn.textContent = originalText;
              
              setTimeout(function() {
                updateEndTimeSlots();
                loadSchedule();
              }, 500);
            } else {
              submitBtn.disabled = false;
              submitBtn.textContent = originalText;
              hideMessage();
            }
          })
          .withFailureHandler(function(error) {
            console.error('Error checking duplicate:', error);
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
          })
          .checkDuplicateBooking(date, room, startTime, endTime);
      }
    });

    document.getElementById('bookingForm').addEventListener('submit', handleSubmit);
    document.getElementById('loadScheduleBtn').addEventListener('click', loadSchedule);
    document.getElementById('scheduleDate').addEventListener('change', loadSchedule);
    
    document.getElementById('closeModalBtn').addEventListener('click', function() {
      document.getElementById('rulesModal').classList.remove('active');
      sessionStorage.setItem('hasSeenRules', 'true');
    });
    
    document.getElementById('checkinBtn').addEventListener('click', handleCheckIn);
    document.getElementById('checkoutBtn').addEventListener('click', handleCheckOut);

    document.getElementById('checkinCodeInput').addEventListener('input', function(e) {
      e.target.value = e.target.value.toUpperCase();
      if (e.target.value.length === 6) {
        e.target.style.borderColor = '#4caf50';
      } else {
        e.target.style.borderColor = 'rgba(255,255,255,.3)';
      }
    });

    // Export Type Change
    document.getElementById('exportType').addEventListener('change', function() {
      const dateRangeGroup = document.getElementById('exportDateRangeGroup');
      const dateRangeGroup2 = document.getElementById('exportDateRangeGroup2');
      
      if (this.value === 'daterange') {
        dateRangeGroup.style.display = 'block';
        dateRangeGroup2.style.display = 'block';
      } else {
        dateRangeGroup.style.display = 'none';
        dateRangeGroup2.style.display = 'none';
      }
    });

    // Admin Tabs
    document.querySelectorAll('.admin-tab').forEach(tab => {
      tab.addEventListener('click', function() {
        document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        
        this.classList.add('active');
        const tabName = this.getAttribute('data-tab');
        document.getElementById(tabName + 'Tab').classList.add('active');
        
        if (tabName === 'checkins') {
          loadTodayCheckins();
        } else if (tabName === 'locks') {
          loadRoomLocks();
        } else if (tabName === 'analytics') {
          loadDashboardAnalytics();
        } else if (tabName === 'bookings') {
          if (isSearchMode) {
            // Keep search results
          } else {
            loadAdminDashboard();
          }
        } else if (tabName === 'overview') {
          loadDashboardAnalytics();
          loadRecentActivity();
          loadQuickStats();
        }
      });
    });

    // Lock Room Modal
    document.getElementById('confirmLockRoomBtn').addEventListener('click', handleLockRoom);
    document.getElementById('cancelLockRoomBtn').addEventListener('click', function() {
      document.getElementById('lockRoomModal').classList.remove('active');
    });

    // Admin Edit Modal
    document.getElementById('confirmAdminEditBtn').addEventListener('click', handleAdminEdit);
    document.getElementById('cancelAdminEditBtn').addEventListener('click', function() {
      document.getElementById('adminEditModal').classList.remove('active');
      currentAdminEditBooking = null;
    });

    document.getElementById('adminEditRoomSelect').addEventListener('change', function() {
      if (!currentAdminEditBooking) return;
      loadAdminEditTimeSlots();
    });

    document.getElementById('adminEditDate').addEventListener('change', function() {
      if (!currentAdminEditBooking) return;
      loadAdminEditTimeSlots();
    });

    document.getElementById('adminEditStartTime').addEventListener('change', function() {
      if (!currentAdminEditBooking) return;
      loadAdminEditEndTimeSlots();
    });

    // Edit Booking Modal
    document.getElementById('editRoomSelect').addEventListener('change', function() {
      if (!currentEditBooking) return;
      
      const newRoom = this.value;
      if (newRoom) {
        loadEditTimeSlots(
          currentEditBooking.date, 
          newRoom, 
          currentEditBooking.startTime, 
          currentEditBooking.endTime
        );
      }
    });
    
    document.getElementById('editStartTimeSelect').addEventListener('change', function() {
      if (!currentEditBooking) return;
      
      const newStartTime = this.value;
      const newRoom = document.getElementById('editRoomSelect').value;
      
      if (newStartTime && newRoom) {
        loadEditEndTimeSlots(
          currentEditBooking.date, 
          newRoom, 
          newStartTime, 
          null
        );
      }
    });
    
    document.getElementById('confirmEditBookingBtn').addEventListener('click', handleEditBooking);
    document.getElementById('cancelEditBookingBtn').addEventListener('click', function() {
      document.getElementById('editBookingModal').classList.remove('active');
      currentEditBooking = null;
    });

    // ===============================
    // UTILITY FUNCTIONS
    // ===============================

    function timeToMinutesClient(time) {
      if (typeof time !== 'string') return 0;
      const parts = time.split(':');
      if (parts.length !== 2) return 0;
      const hours = parseInt(parts[0], 10);
      const minutes = parseInt(parts[1], 10);
      if (isNaN(hours) || isNaN(minutes)) return 0;
      return hours * 60 + minutes;
    }

    // ===============================
    // AUTHENTICATION FUNCTIONS
    // ===============================

    function handleLogin(e) {
      e.preventDefault();
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      
      const btn = document.getElementById('loginBtn');
      btn.disabled = true;
      btn.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...';
      
      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            userEmail = email;
            userType = result.userType;
            userLoggedIn = true;
            
            sessionStorage.setItem('userEmail', email);
            sessionStorage.setItem('userType', result.userType);
            
            showApp();
            
            if (!sessionStorage.getItem('hasSeenRules') && result.userType !== 'admin') {
              setTimeout(function() {
                document.getElementById('rulesModal').classList.add('active');
              }, 500);
            }
          } else {
            showLoginMessage(result.message, 'error');
          }
          btn.disabled = false;
          btn.textContent = '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö';
        })
        .withFailureHandler(function(error) {
          showLoginMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.toString(), 'error');
          btn.disabled = false;
          btn.textContent = '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö';
        })
        .validateLogin(email, password);
    }

    function handleLogout() {
  if (confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö?')) {
    // Clear session
    sessionStorage.clear();
    
    // Reset all states
    userLoggedIn = false;
    userEmail = '';
    userType = '';
    
    // Stop auto-refresh
    if (autoRefreshInterval) {
      clearInterval(autoRefreshInterval);
      autoRefreshInterval = null;
    }
    
    // Hide all containers
    document.getElementById('mainContainer').classList.remove('active');
    document.getElementById('adminDashboard').classList.remove('active');
    document.getElementById('userInfo').classList.remove('active');
    
    // Reset and show login page
    document.getElementById('loginPage').style.display = 'block';
    document.getElementById('loginForm').reset();
    document.getElementById('loginEmail').value = '';
    document.getElementById('loginPassword').value = '';
    document.getElementById('passwordGroup').style.display = 'none';
    
    // Clear any messages
    document.getElementById('loginMessage').style.display = 'none';
  }
}

    function showApp() {
      document.getElementById('loginPage').style.display = 'none';
      document.getElementById('userInfo').classList.add('active');
      document.getElementById('userEmail').textContent = userEmail;
      
      const badge = document.getElementById('userBadge');
      if (userType === 'admin') {
        badge.textContent = 'ADMIN';
        badge.className = 'user-badge badge-admin';
        document.getElementById('adminDashboard').classList.add('active');
        loadAdminDashboard();
        loadTodayCheckins();
        loadRoomLocks();
        loadDashboardAnalytics();
        loadRecentActivity();
        loadQuickStats();
      } else if (userType === 'test') {
        badge.textContent = 'TEST USER';
        badge.className = 'user-badge badge-test';
        document.getElementById('mainContainer').classList.add('active');
        loadMyBookings();
      } else {
        badge.textContent = 'USER';
        badge.className = 'user-badge badge-user';
        document.getElementById('mainContainer').classList.add('active');
        loadMyBookings();
      }
      
      loadSchedule();
    }

    function showLoginMessage(text, type) {
      const messageDiv = document.getElementById('loginMessage');
      messageDiv.textContent = text;
      messageDiv.className = 'message ' + type;
      messageDiv.style.display = 'block';
      
      setTimeout(function() {
        messageDiv.style.display = 'none';
      }, 5000);
    }

    function showMessage(text, type) {
      const messageDiv = document.getElementById('message');
      messageDiv.textContent = text;
      messageDiv.className = 'message ' + type;
      messageDiv.style.display = 'block';
      
      setTimeout(function() {
        messageDiv.style.display = 'none';
      }, 5000);
    }

    function hideMessage() {
      document.getElementById('message').style.display = 'none';
    }

    function showCheckinMessage(text, type) {
      const messageDiv = document.getElementById('checkinMessage');
      messageDiv.textContent = text;
      messageDiv.className = 'message ' + type;
      messageDiv.style.display = 'block';
      
      setTimeout(function() {
        messageDiv.style.display = 'none';
      }, 5000);
    }// ===============================
    // BOOKING FUNCTIONS
    // ===============================

    function handleSubmit(e) {
      e.preventDefault();
      
      const data = {
        room: document.getElementById('room').value,
        date: document.getElementById('date').value,
        startTime: document.getElementById('startTime').value,
        endTime: document.getElementById('endTime').value,
        name: document.getElementById('name').value,
        department: document.getElementById('department').value,
        studentId: document.getElementById('studentId').value,
        phone: document.getElementById('phone').value,
        loginEmail: userEmail
      };
      
      document.querySelector('.loading').style.display = 'block';
      const submitBtn = document.getElementById('submitBtn');
      submitBtn.disabled = true;
      
      google.script.run
        .withSuccessHandler(function(result) {
          document.querySelector('.loading').style.display = 'none';
          
          if (result.success) {
            showMessage(result.message, 'success');
            document.getElementById('bookingForm').reset();
            document.getElementById('startTime').disabled = true;
            document.getElementById('endTime').disabled = true;
            submitBtn.disabled = true;
            
            loadMyBookings();
            loadSchedule();
          } else {
            showMessage(result.message, 'error');
            submitBtn.disabled = false;
          }
        })
        .withFailureHandler(function(error) {
          document.querySelector('.loading').style.display = 'none';
          showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.toString(), 'error');
          submitBtn.disabled = false;
        })
        .saveReservation(data);
    }

    function updateAvailableSlots() {
      const room = document.getElementById('room').value;
      const date = document.getElementById('date').value;
      const startTimeSelect = document.getElementById('startTime');
      const endTimeSelect = document.getElementById('endTime');
      
      if (!room || !date) {
        startTimeSelect.innerHTML = '<option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡πà‡∏≠‡∏ô --</option>';
        startTimeSelect.disabled = true;
        endTimeSelect.innerHTML = '<option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô --</option>';
        endTimeSelect.disabled = true;
        return;
      }
      
      startTimeSelect.innerHTML = '<option value="">-- ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î... --</option>';
      startTimeSelect.disabled = true;
      
      google.script.run
        .withSuccessHandler(function(availableSlots) {
          startTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° --</option>';
          
          if (availableSlots.length > 0) {
            for (let i = 0; i < availableSlots.length; i++) {
              const option = document.createElement('option');
              option.value = availableSlots[i];
              option.textContent = availableSlots[i] + ' ‡∏ô.';
              startTimeSelect.appendChild(option);
            }
            startTimeSelect.disabled = false;
          } else {
            startTimeSelect.innerHTML = '<option value="">-- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡πà‡∏≤‡∏á --</option>';
          }
        })
        .withFailureHandler(function(error) {
          console.error('Error loading slots:', error);
          startTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î --</option>';
        })
        .getAvailableTimeSlots(date, room);
    }

    function updateEndTimeSlots() {
      const room = document.getElementById('room').value;
      const date = document.getElementById('date').value;
      const startTime = document.getElementById('startTime').value;
      const endTimeSelect = document.getElementById('endTime');
      
      if (!startTime) {
        endTimeSelect.innerHTML = '<option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô --</option>';
        endTimeSelect.disabled = true;
        return;
      }
      
      endTimeSelect.innerHTML = '<option value="">-- ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î... --</option>';
      endTimeSelect.disabled = true;
      
      google.script.run
        .withSuccessHandler(function(availableEndTimes) {
          endTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î --</option>';
          
          if (availableEndTimes.length > 0) {
            for (let i = 0; i < availableEndTimes.length; i++) {
              const option = document.createElement('option');
              option.value = availableEndTimes[i];
              option.textContent = availableEndTimes[i] + ' ‡∏ô.';
              endTimeSelect.appendChild(option);
            }
            endTimeSelect.disabled = false;
          } else {
            endTimeSelect.innerHTML = '<option value="">-- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡πà‡∏≤‡∏á --</option>';
          }
        })
        .withFailureHandler(function(error) {
          console.error('Error loading end times:', error);
          endTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î --</option>';
        })
        .getAvailableEndTimes(date, room, startTime);
    }

    function loadMyBookings() {
      google.script.run
        .withSuccessHandler(function(reservations) {
          displayMyBookings(reservations);
        })
        .withFailureHandler(function(error) {
          console.error('Error loading bookings:', error);
        })
        .getMyBookingsWithCheckin(userEmail);
    }

    function displayMyBookings(reservations) {
      const container = document.getElementById('myBookingsList');
      
      if (reservations.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:20px;">‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</p>';
        return;
      }
      
      let html = '';
      reservations.forEach(function(booking) {
        const checkedInClass = booking.isCheckedIn ? ' checked-in' : '';
        const checkedOutClass = booking.isCheckedOut ? ' checked-out' : '';
        
        html += '<div class="booking-item' + checkedInClass + checkedOutClass + '">';
        html += '<h4>' + booking.room + '</h4>';
        html += '<p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> ' + booking.date + '</p>';
        html += '<p><strong>‡πÄ‡∏ß‡∏•‡∏≤:</strong> ' + booking.startTime + ' - ' + booking.endTime + '</p>';
        html += '<p><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ' + booking.name + '</p>';
        
        if (booking.checkinCode) {
          html += '<div class="booking-code-display">';
          html += '<div class="code-label">‡∏£‡∏´‡∏±‡∏™ Check-in</div>';
          html += '<div class="code-value">' + booking.checkinCode + '</div>';
          html += '</div>';
        }
        
        if (booking.isCheckedIn) {
          html += '<p style="color:#f57c00;font-weight:600;">‚úÖ Check-in ‡πÅ‡∏•‡πâ‡∏ß: ' + booking.checkinTime + '</p>';
        }
        
        if (booking.isCheckedOut) {
          html += '<p style="color:#2e7d32;font-weight:600;">üèÅ Check-out ‡πÅ‡∏•‡πâ‡∏ß: ' + booking.checkoutTime + '</p>';
        }
        
        if (booking.editCount !== undefined) {
          const remainingEdits = 2 - booking.editCount;
          const badgeClass = remainingEdits === 0 ? 'edit-count-warning' : 'edit-count-badge';
          html += '<span class="' + badgeClass + '">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß ' + booking.editCount + '/2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</span>';
        }
        
        if (!booking.isCheckedIn && !booking.isCheckedOut) {
          html += '<div class="action-buttons-group">';
          html += '<button class="delete-btn btn-edit" onclick="openEditBookingModal(' + booking.rowIndex + ',\'' + booking.room + '\',\'' + booking.date + '\',\'' + booking.startTime + '\',\'' + booking.endTime + '\',\'' + booking.email + '\',' + (booking.editCount || 0) + ')">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>';
          html += '<button class="delete-btn btn-danger" onclick="deleteBooking(' + booking.rowIndex + ',\'' + booking.email + '\')">üóëÔ∏è ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>';
          html += '</div>';
        }
        
        html += '</div>';
      });
      
      container.innerHTML = html;
    }

    function deleteBooking(rowIndex, reservationEmail) {
      if (!confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) return;
      
      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            alert(result.message);
            loadMyBookings();
            loadSchedule();
          } else {
            alert(result.message);
          }
        })
        .withFailureHandler(function(error) {
          alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.toString());
        })
        .deleteReservation(rowIndex, userEmail, reservationEmail);
    }

    // ===============================
    // CHECK-IN/CHECK-OUT FUNCTIONS
    // ===============================

    function handleCheckIn() {
      const code = document.getElementById('checkinCodeInput').value.trim();
      
      if (!code || code.length !== 6) {
        showCheckinMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™ Check-in 6 ‡∏´‡∏•‡∏±‡∏Å', 'error');
        return;
      }
      
      const btn = document.getElementById('checkinBtn');
      btn.disabled = true;
      btn.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á Check-in...';
      
      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            showCheckinMessage('‚úÖ ' + result.message, 'success');
            document.getElementById('checkinCodeInput').value = '';
            loadMyBookings();
          } else {
            showCheckinMessage('‚ùå ' + result.message, 'error');
          }
          btn.disabled = false;
          btn.textContent = '‚úì Check-in';
        })
        .withFailureHandler(function(error) {
          showCheckinMessage('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.toString(), 'error');
          btn.disabled = false;
          btn.textContent = '‚úì Check-in';
        })
        .checkIn(code, userEmail);
    }

    function handleCheckOut() {
      const code = document.getElementById('checkinCodeInput').value.trim();
      
      if (!code || code.length !== 6) {
        showCheckinMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™ Check-in 6 ‡∏´‡∏•‡∏±‡∏Å', 'error');
        return;
      }
      
      const btn = document.getElementById('checkoutBtn');
      btn.disabled = true;
      btn.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á Check-out...';
      
      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            showCheckinMessage('‚úÖ ' + result.message, 'success');
            document.getElementById('checkinCodeInput').value = '';
            loadMyBookings();
          } else {
            showCheckinMessage('‚ùå ' + result.message, 'error');
          }
          btn.disabled = false;
          btn.textContent = '‚úì Check-out';
        })
        .withFailureHandler(function(error) {
          showCheckinMessage('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.toString(), 'error');
          btn.disabled = false;
          btn.textContent = '‚úì Check-out';
        })
        .checkOut(code, userEmail);
    }

    // ===============================
    // SCHEDULE TABLE FUNCTIONS
    // ===============================

    function loadSchedule() {
      const date = document.getElementById('scheduleDate').value;
      const scheduleBody = document.getElementById('scheduleBody');
      
      if (!date) {
        scheduleBody.innerHTML = '<tr><td colspan="10" style="text-align:center;padding:30px;color:#666;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á</td></tr>';
        return;
      }
      
      scheduleBody.innerHTML = '<tr><td colspan="10" style="text-align:center;padding:30px;color:#666;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>';
      
      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            generateScheduleTable(result.reservations, result.locks, date);
          } else {
            scheduleBody.innerHTML = '<tr><td colspan="10" style="text-align:center;padding:30px;color:#dc2743;">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + (result.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ') + '</td></tr>';
          }
        })
        .withFailureHandler(function(error) {
          console.error('Error loading schedule:', error);
          scheduleBody.innerHTML = '<tr><td colspan="10" style="text-align:center;padding:30px;color:#dc2743;">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
        })
        .getScheduleData(date);
    }

    function generateScheduleTable(reservations, locks, selectedDate) {
      const scheduleBody = document.getElementById('scheduleBody');
      let html = '';
      
      for (let i = 0; i < allTimes.length; i++) {
        const time = allTimes[i];
        const nextTime = i < allTimes.length - 1 ? allTimes[i + 1] : '16:00';
        html += '<tr><td class="room-cell">' + time + ' - ' + nextTime + '</td>';
        
        for (let j = 0; j < allRooms.length; j++) {
          const room = allRooms[j];
          
          let isLocked = false;
          let lockReason = '';
          
          if (locks && locks.length > 0) {
            for (let lock of locks) {
              if (lock.room === room && selectedDate >= lock.startDate && selectedDate <= lock.endDate) {
                const slotMinutes = timeToMinutesClient(time);
                const lockStartMinutes = timeToMinutesClient(lock.startTime);
                const lockEndMinutes = timeToMinutesClient(lock.endTime);
                
                if (slotMinutes >= lockStartMinutes && slotMinutes < lockEndMinutes) {
                  isLocked = true;
                  lockReason = lock.reason;
                  break;
                }
              }
            }
          }
          
          if (isLocked) {
            html += '<td class="locked"><div class="booking-info"><strong style="color:#1565c0;">üîí ‡∏•‡πá‡∏≠‡∏Ñ‡πÑ‡∏ß‡πâ</strong><br>' + lockReason + '</div></td>';
            continue;
          }
          
          let isBooked = false;
          let bookingInfo = '';
          let isUsing = false;
          
          if (reservations && reservations.length > 0) {
            for (let k = 0; k < reservations.length; k++) {
              const reservation = reservations[k];
              if (reservation.room === room) {
                const startMinutes = timeToMinutesClient(reservation.startTime);
                const endMinutes = timeToMinutesClient(reservation.endTime);
                const slotMinutes = timeToMinutesClient(time);
                
                if (slotMinutes >= startMinutes && slotMinutes < endMinutes) {
                  if (reservation.isCheckedOut) { 
                    continue; 
                  }
                  
                  isBooked = true;
                  if (reservation.isCheckedIn && !reservation.isCheckedOut) {
                    isUsing = true;
                    bookingInfo = '<div class="booking-info"><strong style="color:#f57c00;">üî∏ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</strong><br>' + reservation.name + '<br>' + reservation.startTime + '-' + reservation.endTime + '</div>';
                  } else {
                    bookingInfo = '<div class="booking-info">' + reservation.name + '<br>' + reservation.startTime + '-' + reservation.endTime + '</div>';
                  }
                  break;
                }
              }
            }
          }
          
          if (isUsing) {
            html += '<td class="using">' + bookingInfo + '</td>';
          } else if (isBooked) {
            html += '<td class="booked">' + bookingInfo + '</td>';
          } else {
            html += '<td class="available" onclick="quickBook(\'' + room + '\',\'' + selectedDate + '\',\'' + time + '\',\'' + nextTime + '\')">‡∏ß‡πà‡∏≤‡∏á</td>';
          }
        }
        html += '</tr>';
      }
      
      scheduleBody.innerHTML = html;
    }

    function quickBook(room, date, startTime, endTime) {
      if (!userLoggedIn) {
        alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á');
        return;
      }
      
      if (userType === 'admin') {
        alert('‚ö†Ô∏è Admin ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏ä‡πâ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á');
        return;
      }
      
      document.querySelector('.booking-container').scrollIntoView({ 
        behavior: 'smooth', 
        block: 'start' 
      });
      
      document.getElementById('room').value = room;
      document.getElementById('date').value = date;
      
      const startTimeSelect = document.getElementById('startTime');
      const endTimeSelect = document.getElementById('endTime');
      
      startTimeSelect.innerHTML = '<option value="' + startTime + '">' + startTime + ' ‡∏ô.</option>';
      startTimeSelect.value = startTime;
      startTimeSelect.disabled = false;
      
      endTimeSelect.innerHTML = '<option value="">-- ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î... --</option>';
      endTimeSelect.disabled = true;
      endTimeSelect.value = '';
      
      const bookingContainer = document.querySelector('.booking-container');
      bookingContainer.style.animation = 'none';
      setTimeout(function() {
        bookingContainer.style.animation = 'pulseBooking 1s ease-in-out';
      }, 10);
      
      showMessage('‚úÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á "' + room + '" ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° ' + startTime + '\n‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î...', 'success');
      
      setTimeout(function() {
        google.script.run
          .withSuccessHandler(function(availableSlots) {
            startTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° --</option>';
            
            if (availableSlots.length > 0) {
              for (let i = 0; i < availableSlots.length; i++) {
                const option = document.createElement('option');
                option.value = availableSlots[i];
                option.textContent = availableSlots[i] + ' ‡∏ô.';
                startTimeSelect.appendChild(option);
              }
              
              if (availableSlots.includes(startTime)) {
                startTimeSelect.value = startTime;
                loadEndTimesForQuickBook(room, date, startTime);
              } else {
                showMessage('‚ö†Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤ ' + startTime + ' ‡∏ñ‡∏π‡∏Å‡∏à‡∏≠‡∏á‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏∑‡πà‡∏ô', 'error');
                startTimeSelect.value = '';
                endTimeSelect.innerHTML = '<option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô --</option>';
                endTimeSelect.disabled = true;
              }
            } else {
              startTimeSelect.innerHTML = '<option value="">-- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡πà‡∏≤‡∏á --</option>';
              endTimeSelect.innerHTML = '<option value="">-- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡πà‡∏≤‡∏á --</option>';
              showMessage('‚ö†Ô∏è ‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å', 'error');
            }
          })
          .withFailureHandler(function(error) {
            console.error('Error loading available slots:', error);
            showMessage('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
            startTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î --</option>';
            endTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î --</option>';
          })
          .getAvailableTimeSlots(date, room);
      }, 500);
    }

    function loadEndTimesForQuickBook(room, date, startTime) {
      const endTimeSelect = document.getElementById('endTime');
      
      google.script.run
        .withSuccessHandler(function(availableEndTimes) {
          endTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î --</option>';
          
          if (availableEndTimes.length > 0) {
            for (let i = 0; i < availableEndTimes.length; i++) {
              const option = document.createElement('option');
              option.value = availableEndTimes[i];
              option.textContent = availableEndTimes[i] + ' ‡∏ô.';
              endTimeSelect.appendChild(option);
            }
            
            endTimeSelect.disabled = false;
            showMessage('‚úÖ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏≠‡∏á! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°', 'success');
          } else {
            endTimeSelect.innerHTML = '<option value="">-- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡πà‡∏≤‡∏á --</option>';
            endTimeSelect.disabled = true;
            showMessage('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏≠‡∏∑‡πà‡∏ô', 'error');
          }
        })
        .withFailureHandler(function(error) {
          console.error('Error loading end times:', error);
          endTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î --</option>';
          endTimeSelect.disabled = true;
          showMessage('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î', 'error');
        })
        .getAvailableEndTimes(date, room, startTime);
    }// ===============================
    // EDIT BOOKING FUNCTIONS
    // ===============================

    function openEditBookingModal(rowIndex, room, date, startTime, endTime, email, editCount) {
      if (editCount >= 2) {
        alert('‚ö†Ô∏è ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ñ‡∏£‡∏ö 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ');
        return;
      }
      
      currentEditBooking = {
        rowIndex: rowIndex,
        room: room,
        date: date,
        startTime: startTime,
        endTime: endTime,
        email: email,
        editCount: editCount
      };
      
      const infoDiv = document.getElementById('editBookingInfo');
      const remainingEdits = 2 - editCount;
      infoDiv.innerHTML = '<p style="margin:0;"><strong>‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:</strong></p>' +
                         '<p style="margin:5px 0 0 0;">üìç ' + room + '</p>' +
                         '<p style="margin:5px 0 0 0;">üìÖ ' + date + ' | ‚è∞ ' + startTime + ' - ' + endTime + '</p>' +
                         '<p style="margin:10px 0 0 0;color:#666;font-size:13px;">‚úèÔ∏è ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: <strong>' + remainingEdits + ' ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</strong></p>';
      
      document.getElementById('editRoomSelect').value = room;
      
      loadEditTimeSlots(date, room, startTime, endTime);
      
      document.getElementById('editBookingModal').classList.add('active');
    }

    function loadEditTimeSlots(date, room, currentStartTime, currentEndTime) {
      const startTimeSelect = document.getElementById('editStartTimeSelect');
      const endTimeSelect = document.getElementById('editEndTimeSelect');
      
      startTimeSelect.innerHTML = '<option value="">-- ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î... --</option>';
      startTimeSelect.disabled = true;
      endTimeSelect.innerHTML = '<option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô --</option>';
      endTimeSelect.disabled = true;
      
      google.script.run
        .withSuccessHandler(function(bookedSlots) {
          startTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° --</option>';
          
          let hasAvailable = false;
          for (let i = 0; i < allTimes.length; i++) {
            const time = allTimes[i];
            const option = document.createElement('option');
            option.value = time;
            option.textContent = time + ' ‡∏ô.';
            
            if (bookedSlots.includes(time) && time !== currentStartTime) {
              option.disabled = true;
              option.textContent += ' (‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á)';
            } else {
              hasAvailable = true;
            }
            
            startTimeSelect.appendChild(option);
          }
          
          if (hasAvailable) {
            startTimeSelect.disabled = false;
            startTimeSelect.value = currentStartTime;
            loadEditEndTimeSlots(date, room, currentStartTime, currentEndTime);
          } else {
            startTimeSelect.innerHTML = '<option value="">-- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡πà‡∏≤‡∏á --</option>';
          }
        })
        .withFailureHandler(function(error) {
          console.error('Error loading edit time slots:', error);
          startTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î --</option>';
        })
        .getBookedSlotsExcludingCurrent(date, room, currentEditBooking.rowIndex);
    }

    function loadEditEndTimeSlots(date, room, startTime, currentEndTime) {
      const endTimeSelect = document.getElementById('editEndTimeSelect');
      
      endTimeSelect.innerHTML = '<option value="">-- ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î... --</option>';
      endTimeSelect.disabled = true;
      
      google.script.run
        .withSuccessHandler(function(bookedSlots) {
          endTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î --</option>';
          
          const startIndex = allTimes.indexOf(startTime);
          if (startIndex === -1) {
            endTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á --</option>';
            return;
          }
          
          const endTimes = [...allTimes.slice(startIndex + 1), '16:00'];
          let consecutiveAvailable = 0;
          let hasAvailable = false;
          
          for (let i = 0; i < endTimes.length && consecutiveAvailable < 6; i++) {
            const time = endTimes[i];
            
            if (bookedSlots.includes(time) && time !== currentEndTime) {
              break;
            }
            
            const option = document.createElement('option');
            option.value = time;
            option.textContent = time + ' ‡∏ô.';
            endTimeSelect.appendChild(option);
            
            consecutiveAvailable++;
            hasAvailable = true;
          }
          
          if (hasAvailable) {
            endTimeSelect.disabled = false;
            if (currentEndTime && endTimeSelect.querySelector('option[value="' + currentEndTime + '"]')) {
              endTimeSelect.value = currentEndTime;
            }
          } else {
            endTimeSelect.innerHTML = '<option value="">-- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡πà‡∏≤‡∏á --</option>';
          }
        })
        .withFailureHandler(function(error) {
          console.error('Error loading edit end times:', error);
          endTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î --</option>';
        })
        .getBookedSlotsExcludingCurrent(date, room, currentEditBooking.rowIndex);
    }

    function handleEditBooking() {
      if (!currentEditBooking) return;
      
      const newRoom = document.getElementById('editRoomSelect').value;
      const newStartTime = document.getElementById('editStartTimeSelect').value;
      const newEndTime = document.getElementById('editEndTimeSelect').value;
      
      if (!newRoom || !newStartTime || !newEndTime) {
        showEditBookingMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'error');
        return;
      }
      
      const btn = document.getElementById('confirmEditBookingBtn');
      btn.disabled = true;
      btn.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
      
      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            showEditBookingMessage('‚úÖ ' + result.message, 'success');
            setTimeout(function() {
              document.getElementById('editBookingModal').classList.remove('active');
              currentEditBooking = null;
              loadMyBookings();
              loadSchedule();
            }, 2000);
          } else {
            showEditBookingMessage('‚ùå ' + result.message, 'error');
          }
          btn.disabled = false;
          btn.textContent = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç';
        })
        .withFailureHandler(function(error) {
          showEditBookingMessage('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.toString(), 'error');
          btn.disabled = false;
          btn.textContent = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç';
        })
        .editBooking(
          currentEditBooking.rowIndex,
          newRoom,
          newStartTime,
          newEndTime,
          userEmail,
          currentEditBooking.email
        );
    }

    function showEditBookingMessage(text, type) {
      const messageDiv = document.getElementById('editBookingMessage');
      messageDiv.textContent = text;
      messageDiv.className = 'message ' + type;
      messageDiv.style.display = 'block';
    }

    // ===============================
    // ADMIN FUNCTIONS
    // ===============================

    function loadAdminDashboard() {
      google.script.run
        .withSuccessHandler(function(reservations) {
          displayAdminBookings(reservations);
        })
        .withFailureHandler(function(error) {
          console.error('Error loading admin dashboard:', error);
        })
        .getAllReservations();
    }

    function displayAdminBookings(reservations) {
      const container = document.getElementById('allBookingsList');
      
      if (reservations.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:20px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</p>';
        return;
      }
      
      let html = '';
      reservations.forEach(function(booking) {
        const isCanceled = booking.isCanceled;
        const canceledClass = isCanceled ? ' canceled' : '';
        const checkedInClass = booking.isCheckedIn && !isCanceled ? ' checked-in' : '';
        const checkedOutClass = booking.isCheckedOut && !isCanceled ? ' checked-out' : '';
        
        html += '<div class="booking-item' + checkedInClass + checkedOutClass + canceledClass + '">';
        html += '<h4>' + booking.room + ' | ' + booking.date + '</h4>';
        html += '<p><strong>‡πÄ‡∏ß‡∏•‡∏≤:</strong> ' + booking.startTime + ' - ' + booking.endTime + '</p>';
        html += '<p><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ' + booking.name + '</p>';
        html += '<p><strong>‡∏™‡∏≤‡∏Ç‡∏≤:</strong> ' + booking.department + ' | <strong>‡∏£‡∏´‡∏±‡∏™:</strong> ' + booking.studentId + '</p>';
        html += '<p><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå:</strong> ' + booking.phone + ' | <strong>‡∏≠‡∏µ‡πÄ‡∏°‡∏•:</strong> ' + booking.email + '</p>';
        html += '<p><strong>‡∏£‡∏´‡∏±‡∏™ Check-in:</strong> <span style="font-weight:700;color:#667eea;">' + booking.checkinCode + '</span></p>';
        
        if (isCanceled) {
          const cancelType = booking.canceledType === 'AUTO' ? '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥' : '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÇ‡∏î‡∏¢‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ';
          html += '<p style="color:#757575;font-weight:600;">‚ùå ' + cancelType + '</p>';
        } else {
          if (booking.isCheckedIn) {
            html += '<p style="color:#f57c00;font-weight:600;">‚úÖ Check-in ‡πÅ‡∏•‡πâ‡∏ß</p>';
          }
          if (booking.isCheckedOut) {
            html += '<p style="color:#2e7d32;font-weight:600;">üèÅ Check-out ‡πÅ‡∏•‡πâ‡∏ß</p>';
          }
          
          if (!booking.isCheckedOut) {
            html += '<div class="action-buttons-group">';
            html += '<button class="delete-btn btn-edit" onclick="openAdminEditModal(' + booking.rowIndex + ',\'' + booking.room + '\',\'' + booking.date + '\',\'' + booking.startTime + '\',\'' + booking.endTime + '\',\'' + booking.email + '\',\'' + booking.name + '\')">üîß ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>';
            html += '<button class="delete-btn btn-danger" onclick="adminDeleteBooking(' + booking.rowIndex + ',\'' + booking.email + '\')">üóëÔ∏è ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>';
            html += '</div>';
          }
        }
        
        html += '</div>';
      });
      
      container.innerHTML = html;
    }

    function adminDeleteBooking(rowIndex, reservationEmail) {
      if (!confirm('Admin: ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ô‡∏µ‡πâ?')) return;
      
      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            alert(result.message);
            loadAdminDashboard();
            loadSchedule();
          } else {
            alert(result.message);
          }
        })
        .withFailureHandler(function(error) {
          alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.toString());
        })
        .deleteReservation(rowIndex, userEmail, reservationEmail);
    }

    function openAdminEditModal(rowIndex, room, date, startTime, endTime, email, name) {
      currentAdminEditBooking = {
        rowIndex: rowIndex,
        room: room,
        date: date,
        startTime: startTime,
        endTime: endTime,
        email: email,
        name: name
      };
      
      const infoDiv = document.getElementById('adminEditInfo');
      infoDiv.innerHTML = '<p style="margin:0;"><strong>‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:</strong></p>' +
                         '<p style="margin:5px 0 0 0;">üë§ ' + name + ' (' + email + ')</p>' +
                         '<p style="margin:5px 0 0 0;">üìç ' + room + '</p>' +
                         '<p style="margin:5px 0 0 0;">üìÖ ' + date + ' | ‚è∞ ' + startTime + ' - ' + endTime + '</p>';
      
      document.getElementById('adminEditRoomSelect').value = room;
      document.getElementById('adminEditDate').value = date;
      
      loadAdminEditTimeSlots();
      
      document.getElementById('adminEditModal').classList.add('active');
    }

    function loadAdminEditTimeSlots() {
      const room = document.getElementById('adminEditRoomSelect').value;
      const date = document.getElementById('adminEditDate').value;
      const startTimeSelect = document.getElementById('adminEditStartTime');
      const endTimeSelect = document.getElementById('adminEditEndTime');
      
      if (!room || !date) {
        startTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡πà‡∏≠‡∏ô --</option>';
        endTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô --</option>';
        return;
      }
      
      startTimeSelect.innerHTML = '<option value="">-- ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î... --</option>';
      startTimeSelect.disabled = true;
      endTimeSelect.innerHTML = '<option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô --</option>';
      endTimeSelect.disabled = true;
      
      google.script.run
        .withSuccessHandler(function(bookedSlots) {
          startTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° --</option>';
          
          for (let i = 0; i < allTimes.length; i++) {
            const time = allTimes[i];
            const option = document.createElement('option');
            option.value = time;
            option.textContent = time + ' ‡∏ô.';
            
            if (bookedSlots.includes(time) && time !== currentAdminEditBooking.startTime) {
              option.disabled = true;
              option.textContent += ' (‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á)';
            }
            
            startTimeSelect.appendChild(option);
          }
          
          startTimeSelect.disabled = false;
          startTimeSelect.value = currentAdminEditBooking.startTime;
          loadAdminEditEndTimeSlots();
        })
        .withFailureHandler(function(error) {
          console.error('Error loading admin edit time slots:', error);
          startTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î --</option>';
        })
        .getBookedSlotsExcludingCurrent(date, room, currentAdminEditBooking.rowIndex);
    }

    function loadAdminEditEndTimeSlots() {
      const room = document.getElementById('adminEditRoomSelect').value;
      const date = document.getElementById('adminEditDate').value;
      const startTime = document.getElementById('adminEditStartTime').value;
      const endTimeSelect = document.getElementById('adminEditEndTime');
      
      if (!startTime) {
        endTimeSelect.innerHTML = '<option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô --</option>';
        endTimeSelect.disabled = true;
        return;
      }
      
      endTimeSelect.innerHTML = '<option value="">-- ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î... --</option>';
      endTimeSelect.disabled = true;
      
      google.script.run
        .withSuccessHandler(function(bookedSlots) {
          endTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î --</option>';
          
          const startIndex = allTimes.indexOf(startTime);
          if (startIndex === -1) {
            endTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á --</option>';
            return;
          }
          
          const endTimes = [...allTimes.slice(startIndex + 1), '16:00'];
          
          for (let i = 0; i < endTimes.length; i++) {
            const time = endTimes[i];
            
            if (bookedSlots.includes(time) && time !== currentAdminEditBooking.endTime) {
              break;
            }
            
            const option = document.createElement('option');
            option.value = time;
            option.textContent = time + ' ‡∏ô.';
            endTimeSelect.appendChild(option);
          }
          
          endTimeSelect.disabled = false;
          if (endTimeSelect.querySelector('option[value="' + currentAdminEditBooking.endTime + '"]')) {
            endTimeSelect.value = currentAdminEditBooking.endTime;
          }
        })
        .withFailureHandler(function(error) {
          console.error('Error loading admin edit end times:', error);
          endTimeSelect.innerHTML = '<option value="">-- ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î --</option>';
        })
        .getBookedSlotsExcludingCurrent(date, room, currentAdminEditBooking.rowIndex);
    }

    function handleAdminEdit() {
      if (!currentAdminEditBooking) return;
      
      const newRoom = document.getElementById('adminEditRoomSelect').value;
      const newDate = document.getElementById('adminEditDate').value;
      const newStartTime = document.getElementById('adminEditStartTime').value;
      const newEndTime = document.getElementById('adminEditEndTime').value;
      
      if (!newRoom || !newDate || !newStartTime || !newEndTime) {
        showAdminEditMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'error');
        return;
      }
      
      const btn = document.getElementById('confirmAdminEditBtn');
      btn.disabled = true;
      btn.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
      
      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            showAdminEditMessage('‚úÖ ' + result.message, 'success');
            setTimeout(function() {
              document.getElementById('adminEditModal').classList.remove('active');
              currentAdminEditBooking = null;
              loadAdminDashboard();
              loadSchedule();
            }, 2000);
          } else {
            showAdminEditMessage('‚ùå ' + result.message, 'error');
          }
          btn.disabled = false;
          btn.textContent = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç';
        })
        .withFailureHandler(function(error) {
          showAdminEditMessage('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.toString(), 'error');
          btn.disabled = false;
          btn.textContent = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç';
        })
        .adminEditBooking(
          currentAdminEditBooking.rowIndex,
          newRoom,
          newDate,
          newStartTime,
          newEndTime,
          userEmail
        );
    }

    function showAdminEditMessage(text, type) {
      const messageDiv = document.getElementById('adminEditMessage');
      messageDiv.textContent = text;
      messageDiv.className = 'message ' + type;
      messageDiv.style.display = 'block';
    }

    function loadTodayCheckins() {
      google.script.run
        .withSuccessHandler(function(checkins) {
          displayTodayCheckins(checkins);
        })
        .withFailureHandler(function(error) {
          console.error('Error loading today checkins:', error);
        })
        .getTodayCheckins();
    }

    function displayTodayCheckins(checkins) {
      const container = document.getElementById('todayCheckinsList');
      
      if (checkins.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:20px;">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</p>';
        return;
      }
      
      let html = '';
      checkins.forEach(function(checkin) {
        let statusClass = '';
        let statusIcon = '';
        
        if (checkin.status === '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥' || checkin.status === '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÇ‡∏î‡∏¢‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ') {
          statusClass = 'status-canceled';
          statusIcon = '‚ùå';
        } else if (checkin.status === '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô') {
          statusClass = 'status-completed';
          statusIcon = 'üèÅ';
        } else if (checkin.status === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô') {
          statusClass = 'status-using';
          statusIcon = 'üî∏';
        } else {
          statusClass = 'status-waiting';
          statusIcon = '‚è≥';
        }
        
        html += '<div class="booking-item">';
        html += '<h4>' + checkin.room + ' <span class="status-badge ' + statusClass + '">' + statusIcon + ' ' + checkin.status + '</span></h4>';
        html += '<p><strong>‡πÄ‡∏ß‡∏•‡∏≤:</strong> ' + checkin.startTime + ' - ' + checkin.endTime + '</p>';
        html += '<p><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ' + checkin.name + ' | <strong>‡∏™‡∏≤‡∏Ç‡∏≤:</strong> ' + checkin.department + '</p>';
        html += '<p><strong>‡∏≠‡∏µ‡πÄ‡∏°‡∏•:</strong> ' + checkin.email + '</p>';
        html += '<p><strong>‡∏£‡∏´‡∏±‡∏™ Check-in:</strong> <span style="font-weight:700;color:#667eea;">' + checkin.checkinCode + '</span></p>';
        
        if (checkin.isCheckedIn) {
          html += '<p style="color:#f57c00;font-weight:600;">‚úÖ Check-in: ' + checkin.checkinTime + '</p>';
        }
        if (checkin.isCheckedOut) {
          html += '<p style="color:#2e7d32;font-weight:600;">üèÅ Check-out: ' + checkin.checkoutTime + '</p>';
        }
        
        html += '</div>';
      });
      
      container.innerHTML = html;
    }

    function loadRoomLocks() {
      google.script.run
        .withSuccessHandler(function(locks) {
          displayRoomLocks(locks);
        })
        .withFailureHandler(function(error) {
          console.error('Error loading room locks:', error);
        })
        .getRoomLocks();
    }

    function displayRoomLocks(locks) {
      const container = document.getElementById('roomLocksList');
      
      if (locks.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:20px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ</p>';
        return;
      }
      
      let html = '';
      locks.forEach(function(lock) {
        html += '<div class="lock-item">';
        html += '<h4>üîí ' + lock.room + '</h4>';
        html += '<p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> ' + lock.startDate + ' ‡∏ñ‡∏∂‡∏á ' + lock.endDate + '</p>';
        html += '<p><strong>‡πÄ‡∏ß‡∏•‡∏≤:</strong> ' + lock.startTime + ' - ' + lock.endTime + '</p>';
        html += '<p><strong>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•:</strong> ' + lock.reason + '</p>';
        html += '<p><strong>Admin:</strong> ' + lock.adminEmail + '</p>';
        html += '<button class="btn-danger" onclick="unlockRoom(\'' + lock.lockId + '\')">üîì ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ</button>';
        html += '</div>';
      });
      
      container.innerHTML = html;
    }

    function openLockRoomModal() {
      document.getElementById('lockRoomModal').classList.add('active');
    }

    function handleLockRoom() {
      const room = document.getElementById('lockRoomSelect').value;
      const startDate = document.getElementById('lockStartDate').value;
      const endDate = document.getElementById('lockEndDate').value;
      const startTime = document.getElementById('lockStartTime').value;
      const endTime = document.getElementById('lockEndTime').value;
      const reason = document.getElementById('lockReason').value;
      
      if (!room || !startDate || !endDate || !reason) {
        showLockRoomMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'error');
        return;
      }
      
      const btn = document.getElementById('confirmLockRoomBtn');
      btn.disabled = true;
      btn.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡πá‡∏≠‡∏Ñ...';
      
      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            showLockRoomMessage('‚úÖ ' + result.message, 'success');
            document.getElementById('lockRoomSelect').value = '';
            document.getElementById('lockStartDate').value = '';
            document.getElementById('lockEndDate').value = '';
            document.getElementById('lockReason').value = '';
            
            setTimeout(function() {
              document.getElementById('lockRoomModal').classList.remove('active');
              loadRoomLocks();
              loadSchedule();
            }, 2000);
          } else {
            showLockRoomMessage('‚ùå ' + result.message, 'error');
          }
          btn.disabled = false;
          btn.textContent = 'üîí ‡∏•‡πá‡∏≠‡∏Ñ‡∏´‡πâ‡∏≠‡∏á';
        })
        .withFailureHandler(function(error) {
          showLockRoomMessage('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.toString(), 'error');
          btn.disabled = false;
          btn.textContent = 'üîí ‡∏•‡πá‡∏≠‡∏Ñ‡∏´‡πâ‡∏≠‡∏á';
        })
        .lockRoom(room, startDate, endDate, startTime, endTime, reason, userEmail);
    }

    function showLockRoomMessage(text, type) {
      const messageDiv = document.getElementById('lockRoomMessage');
      messageDiv.textContent = text;
      messageDiv.className = 'message ' + type;
      messageDiv.style.display = 'block';
    }

    function unlockRoom(lockId) {
      if (!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ?')) return;
      
      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            alert(result.message);
            loadRoomLocks();
            loadSchedule();
          } else {
            alert(result.message);
          }
        })
        .withFailureHandler(function(error) {
          alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.toString());
        })
        .unlockRoom(lockId, userEmail);
    }

    function loadDashboardAnalytics() {
      google.script.run
        .withSuccessHandler(function(analytics) {
          document.getElementById('totalBookings').textContent = analytics.totalBookings;
          document.getElementById('activeBookings').textContent = analytics.activeBookings;
          document.getElementById('completedBookings').textContent = analytics.completedBookings;
          document.getElementById('cancelledBookings').textContent = analytics.cancelledBookings;
          document.getElementById('weekBookings').textContent = analytics.weekBookings;
          document.getElementById('monthBookings').textContent = analytics.monthBookings;
          document.getElementById('totalUsers').textContent = analytics.userStats.totalUsers;
          
          displayRoomUsageChart(analytics.roomUsage);
          displayPeakHoursChart(analytics.peakHours);
        })
        .withFailureHandler(function(error) {
          console.error('Error loading analytics:', error);
        })
        .getDashboardAnalytics();
    }

    function loadQuickStats() {
      google.script.run
        .withSuccessHandler(function(stats) {
          document.getElementById('quickTotalToday').textContent = stats.totalToday;
          document.getElementById('quickWaitingCheckin').textContent = stats.waitingCheckin;
          document.getElementById('quickCheckedInToday').textContent = stats.checkedInToday;
          document.getElementById('quickCompletedToday').textContent = stats.completedToday;
          document.getElementById('quickCancelledToday').textContent = stats.cancelledToday;
        })
        .withFailureHandler(function(error) {
          console.error('Error loading quick stats:', error);
        })
        .getQuickStats();
    }

    function displayRoomUsageChart(roomUsage) {
      const container = document.getElementById('roomUsageChart');
      let html = '';
      
      const maxValue = Math.max(...Object.values(roomUsage), 1);
      
      for (let room in roomUsage) {
        const count = roomUsage[room];
        const percentage = (count / maxValue) * 100;
        
        html += '<div class="chart-bar">';
        html += '<div class="chart-bar-label"><span>' + room + '</span><span>' + count + ' ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</span></div>';
        html += '<div class="chart-bar-fill" style="width:' + percentage + '%"></div>';
        html += '</div>';
      }
      
      container.innerHTML = html;
    }

    function displayPeakHoursChart(peakHours) {
      const container = document.getElementById('peakHoursChart');
      let html = '';
      
      const maxValue = Math.max(...Object.values(peakHours), 1);
      
      for (let hour in peakHours) {
        const count = peakHours[hour];
        const percentage = (count / maxValue) * 100;
        
        html += '<div class="chart-bar">';
        html += '<div class="chart-bar-label"><span>' + hour + ' ‡∏ô.</span><span>' + count + ' ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</span></div>';
        html += '<div class="chart-bar-fill" style="width:' + percentage + '%"></div>';
        html += '</div>';
      }
      
      container.innerHTML = html;
    }

    function loadRecentActivity() {
      google.script.run
        .withSuccessHandler(function(activities) {
          displayRecentActivity(activities);
        })
        .withFailureHandler(function(error) {
          console.error('Error loading recent activity:', error);
        })
        .getRecentActivity(10);
    }

    function displayRecentActivity(activities) {
      const container = document.getElementById('recentActivity');
      
      if (activities.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:20px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</p>';
        return;
      }
      
      let html = '';
      activities.forEach(function(activity) {
        html += '<div class="activity-item">';
        html += '<div class="activity-time">' + activity.date + ' ' + activity.time + '</div>';
        html += '<div class="activity-desc">';
        html += '<strong>' + activity.name + '</strong> ' + activity.action + ' ';
        html += activity.room + ' (' + activity.bookingDate + ')';
        html += '</div>';
        html += '</div>';
      });
      
      container.innerHTML = html;
    }

    function searchBookings() {
      const searchType = document.getElementById('searchType').value;
      const searchTerm = document.getElementById('searchTerm').value.trim();
      
      if (!searchTerm) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤');
        return;
      }
      
      google.script.run
        .withSuccessHandler(function(results) {
          isSearchMode = true;
          displaySearchResults(results, searchTerm);
        })
        .withFailureHandler(function(error) {
          alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.toString());
        })
        .searchBookings(searchTerm, searchType);
    }

    function displaySearchResults(results, searchTerm) {
      const headerDiv = document.getElementById('searchResultsHeader');
      const container = document.getElementById('allBookingsList');
      
      headerDiv.style.display = 'block';
      headerDiv.className = 'search-results-header';
      headerDiv.innerHTML = '<div class="result-count">üîç ‡∏û‡∏ö‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: <strong>' + results.length + '</strong> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: "' + searchTerm + '")</div>';
      
      if (results.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:20px;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>';
        return;
      }
      
      displayAdminBookings(results);
    }

    function clearSearch() {
      isSearchMode = false;
      document.getElementById('searchTerm').value = '';
      document.getElementById('searchResultsHeader').style.display = 'none';
      loadAdminDashboard();
    }

    function exportToExcel() {
      const exportType = document.getElementById('exportType').value;
      const startDate = document.getElementById('exportStartDate').value;
      const endDate = document.getElementById('exportEndDate').value;
      
      if (exportType === 'daterange' && (!startDate || !endDate)) {
        alert('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î');
        return;
      }
      
      const resultDiv = document.getElementById('exportResultMessage');
      resultDiv.style.display = 'block';
      resultDiv.className = 'export-result-message';
      resultDiv.innerHTML = '<p style="margin:0;">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå Excel ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</p>';
      
      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            resultDiv.innerHTML = '<h4>‚úÖ Export ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h4>' +
                                 '<p>' + result.message + '</p>' +
                                 '<a href="' + result.url + '" target="_blank" class="export-download-link">üì• ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå Excel</a>';
          } else {
            resultDiv.innerHTML = '<p style="margin:0;color:#dc2743;">‚ùå ' + result.message + '</p>';
          }
        })
        .withFailureHandler(function(error) {
          resultDiv.innerHTML = '<p style="margin:0;color:#dc2743;">‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.toString() + '</p>';
        })
        .exportBookingsToExcel(exportType, startDate, endDate);
    }
  </script>
</body>
</html>